import{r as e,c as t,j as n,N as o,a as s,b as r,R as a}from"./react-vendor-d09f2fb9.js";import{c as i,p as c}from"./store-263a9ded.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const l={},d=function(e,t,n){if(!t||0===t.length)return e();const o=document.getElementsByTagName("link");return Promise.all(t.map(e=>{if((e=function(e){return"/Get-Started-with-Web3/"+e}(e))in l)return;l[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(!!n)for(let n=o.length-1;n>=0;n--){const s=o[n];if(s.href===e&&(!t||"stylesheet"===s.rel))return}else if(document.querySelector(`link[href="${e}"]${s}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script",r.crossOrigin=""),r.href=e,document.head.appendChild(r),t?new Promise((t,n)=>{r.addEventListener("load",t),r.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0})).then(()=>e()).catch(e=>{const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e})},h=e.lazy(()=>d(()=>import("./LandingPage-e37a6ee6.js"),["assets/LandingPage-e37a6ee6.js","assets/react-vendor-d09f2fb9.js","assets/ui-ee05c837.js"])),m=e.lazy(()=>d(()=>import("./DashboardPage-af18bbc8.js"),["assets/DashboardPage-af18bbc8.js","assets/react-vendor-d09f2fb9.js","assets/useUserStore-0519b8dd.js","assets/store-263a9ded.js","assets/courseData-f0043609.js","assets/ui-ee05c837.js"])),p=e.lazy(()=>d(()=>import("./ReaderPage-b5f4e59e.js"),["assets/ReaderPage-b5f4e59e.js","assets/react-vendor-d09f2fb9.js","assets/useUserStore-0519b8dd.js","assets/store-263a9ded.js","assets/ui-ee05c837.js","assets/courseData-f0043609.js"])),u=e.lazy(()=>d(()=>import("./BadgeCollectionPage-8d8237ec.js"),["assets/BadgeCollectionPage-8d8237ec.js","assets/react-vendor-d09f2fb9.js","assets/useUserStore-0519b8dd.js","assets/store-263a9ded.js","assets/ui-ee05c837.js"])),g=()=>n.jsx("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500"}),n.jsx("p",{className:"mt-4 text-slate-400",children:"加载中..."})]})}),f=({children:t})=>n.jsx(e.Suspense,{fallback:n.jsx(g,{}),children:t}),w=t([{path:"/",element:n.jsx(f,{children:n.jsx(h,{})})},{path:"/dashboard",element:n.jsx(f,{children:n.jsx(m,{})})},{path:"/learn/:moduleId/:lessonId",element:n.jsx(f,{children:n.jsx(p,{})})},{path:"/badges",element:n.jsx(f,{children:n.jsx(u,{})})},{path:"*",element:n.jsx(o,{to:"/",replace:!0})}],{basename:"/Get-Started-with-Web3"}),b=i(c(e=>({geminiApiKey:"",apiKeySet:!1,showApiSettings:!1,showBadgeCollection:!1,pendingBadgeUnlock:null,showConfetti:!1,particlesEnabled:!0,soundEnabled:!0,gasPrice:20,starPromptDismissed:!1,setGeminiApiKey:t=>e({geminiApiKey:t,apiKeySet:!!t}),clearGeminiApiKey:()=>e({geminiApiKey:"",apiKeySet:!1}),toggleApiSettings:()=>e(e=>({showApiSettings:!e.showApiSettings})),setShowApiSettings:t=>e({showApiSettings:t}),toggleBadgeCollection:()=>e(e=>({showBadgeCollection:!e.showBadgeCollection})),setShowBadgeCollection:t=>e({showBadgeCollection:t}),setPendingBadgeUnlock:t=>e({pendingBadgeUnlock:t}),triggerConfetti:()=>{e({showConfetti:!0}),setTimeout(()=>{e({showConfetti:!1})},5e3)},toggleParticles:()=>e(e=>({particlesEnabled:!e.particlesEnabled})),toggleSound:()=>e(e=>({soundEnabled:!e.soundEnabled})),updateGasPrice:()=>{const t=Math.floor(15*Math.random())+15;e({gasPrice:t})},dismissStarPrompt:()=>e({starPromptDismissed:!0}),resetUIState:()=>e({showApiSettings:!1,showBadgeCollection:!1,pendingBadgeUnlock:null,showConfetti:!1})}),{name:"web3-app-store",partialize:e=>({geminiApiKey:e.geminiApiKey,apiKeySet:e.apiKeySet,particlesEnabled:e.particlesEnabled,soundEnabled:e.soundEnabled,starPromptDismissed:e.starPromptDismissed})})),y=i((e,t)=>({activeModule:null,activeLesson:null,contentCache:{},contentLoading:!1,fetchError:null,basePath:"/Get-Started-with-Web3/",setActiveModule:t=>e({activeModule:t}),setActiveLesson:(t,n)=>e({activeModule:t,activeLesson:n}),clearActiveLesson:()=>e({activeLesson:null}),fetchLessonContent:async n=>{const{contentCache:o}=t();if(o[n])return o[n].content;e({contentLoading:!0,fetchError:null});try{const o=`${t().basePath}content/${n}/README.md`;let s=await fetch(o);if(!s.ok){const e=`https://raw.githubusercontent.com/beihaili/Get-Started-with-Web3/main/${n}/README.md`;s=await fetch(e)}if(!s.ok)throw new Error(`Failed to fetch content: ${s.status}`);const r=await s.text(),a={content:r,timestamp:Date.now()};return e({contentCache:{...t().contentCache,[n]:a},contentLoading:!1}),r}catch(s){throw e({fetchError:s.message,contentLoading:!1}),s}},clearCache:()=>e({contentCache:{}}),getCachedContent:e=>{const{contentCache:n}=t();return n[e]},removeCachedContent:n=>{const{contentCache:o}=t(),s={...o};delete s[n],e({contentCache:s})},getCacheSize:()=>{const{contentCache:e}=t();return Object.keys(e).length},cleanOldCache:()=>{const{contentCache:n}=t(),o=Date.now(),s=Object.entries(n).reduce((e,[t,n])=>(o-n.timestamp<6048e5&&(e[t]=n),e),{});e({contentCache:s})}}));function E(){const{updateGasPrice:t}=b(),{cleanOldCache:o}=y();return e.useEffect(()=>{t();const e=setInterval(t,1e4);return o(),()=>{clearInterval(e)}},[t,o]),n.jsx("div",{className:"app",children:n.jsx(s,{router:w})})}r.createRoot(document.getElementById("root")).render(n.jsx(a.StrictMode,{children:n.jsx(E,{})}));export{y as a,b as u};
