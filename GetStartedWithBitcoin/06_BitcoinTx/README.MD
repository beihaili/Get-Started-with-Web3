# æ¯”ç‰¹å¸äº¤æ˜“åŸºç¡€

![status](https://img.shields.io/badge/çŠ¶æ€-å·²å®Œæˆ-success)
![author](https://img.shields.io/badge/ä½œè€…-beihaili-blue)
![date](https://img.shields.io/badge/æ—¥æœŸ-2025--06-orange)
![difficulty](https://img.shields.io/badge/éš¾åº¦-åˆçº§-green)

> ğŸ’¡ è‡ªå­¦å…¥é—¨ `Web3` ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹ï¼Œä½œä¸ºä¸€ä¸ªåˆšåˆšå…¥é—¨ Web3 çš„æ–°äººï¼Œæ¢³ç†ä¸€ä¸‹æœ€ç®€å•ç›´è§‚çš„ `Web3` å°ç™½å…¥é—¨æ•™ç¨‹ã€‚æ•´åˆå¼€æºç¤¾åŒºä¼˜è´¨èµ„æºï¼Œä¸ºå¤§å®¶ä»å…¥é—¨åˆ°ç²¾é€š Web3 æŒ‡è·¯ã€‚æ¯å‘¨æ›´æ–° 1-3 è®²ã€‚
> 
> æ¬¢è¿å…³æ³¨æˆ‘çš„æ¨ç‰¹ï¼š[@bhbtc1337](https://twitter.com/bhbtc1337)
> 
> 
> è¿›å…¥å¾®ä¿¡äº¤æµç¾¤è¯·å¡«è¡¨ï¼š[è¡¨æ ¼é“¾æ¥](https://forms.gle/QMBwL6LwZyQew1tX8)
> 
> æ–‡ç« å¼€æºåœ¨ GitHubï¼š[Get-Started-with-Web3](https://github.com/beihaili/Get-Started-with-Web3)
> 
> è´­ä¹°BTC/ETH/USDT ç­‰åŠ å¯†è´§å¸æ¨è [å¸å®‰](https://www.binance.com/zh-CN)[æ³¨å†Œé“¾æ¥](https://accounts.marketwebb.me/register?ref=39797374)

## ç›®å½•

- [å‰è¨€](#å‰è¨€)
- [æ¯”ç‰¹å¸äº¤æ˜“çš„ç»„æˆ](#æ¯”ç‰¹å¸äº¤æ˜“çš„ç»„æˆ)
- [äº¤æ˜“çš„æ ¸å¿ƒè¦ç´ ](#äº¤æ˜“çš„æ ¸å¿ƒè¦ç´ )
- [UTXOæ¨¡å‹](#utxoæ¨¡å‹)
- [æ¯”ç‰¹å¸äº¤æ˜“çš„ç»“æ„](#æ¯”ç‰¹å¸äº¤æ˜“çš„ç»“æ„)
- [äº¤æ˜“éªŒè¯åŸºç¡€](#äº¤æ˜“éªŒè¯åŸºç¡€)
- [å®æˆ˜æ¼”ç»ƒï¼šåŸºç¡€äº¤æ˜“æ“ä½œ](#å®æˆ˜æ¼”ç»ƒåŸºç¡€äº¤æ˜“æ“ä½œ)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
- [ç»“è¯­](#ç»“è¯­)

## å‰è¨€

åœ¨å‰é¢çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†æ¯”ç‰¹å¸çš„åŸºæœ¬æ¦‚å¿µã€é’±åŒ…çš„ä½¿ç”¨ã€èŠ‚ç‚¹çš„æ­å»ºä»¥åŠRPCæ¥å£çš„æ“ä½œã€‚ç°åœ¨ï¼Œæˆ‘ä»¬è¦æ·±å…¥æ¢ç´¢æ¯”ç‰¹å¸ç³»ç»Ÿçš„æ ¸å¿ƒâ€”â€”äº¤æ˜“æœºåˆ¶ã€‚

æ¯”ç‰¹å¸äº¤æ˜“æ˜¯æ•´ä¸ªæ¯”ç‰¹å¸ç³»ç»Ÿçš„åŸºçŸ³ï¼Œæ¯ä¸€ç¬”äº¤æ˜“éƒ½è®°å½•ç€ä»·å€¼çš„è½¬ç§»ï¼Œæ¯ä¸€ä¸ªåŒºå—éƒ½æ‰¿è½½ç€æ•°åƒç¬”äº¤æ˜“çš„è§è¯ã€‚ç†è§£æ¯”ç‰¹å¸äº¤æ˜“çš„æœºåˆ¶ï¼Œä¸ä»…èƒ½è®©æˆ‘ä»¬æ›´å¥½åœ°ä½¿ç”¨æ¯”ç‰¹å¸ï¼Œæ›´èƒ½è®©æˆ‘ä»¬æ·±å…¥ç†è§£åŒºå—é“¾æŠ€æœ¯çš„ç²¾é«“ã€‚

åœ¨è¿™ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä»äº¤æ˜“çš„åŸºæœ¬ç»„æˆå¼€å§‹ï¼Œé€æ­¥æ·±å…¥åˆ°äº¤æ˜“çš„ç»“æ„ã€éªŒè¯è¿‡ç¨‹ï¼Œä¸ºåç»­å­¦ä¹ æ›´é«˜çº§çš„äº¤æ˜“ç±»å‹å’ŒæŠ€æœ¯å‡çº§æ‰“ä¸‹åšå®åŸºç¡€ã€‚

## æ¯”ç‰¹å¸äº¤æ˜“çš„ç»„æˆ

### äº¤æ˜“çš„åŸºæœ¬ä»‹ç»

æƒ³è±¡ä¸€ä¸‹å¦‚æœä½ æ‹¿ç€ä¸€ä¸ªè´¦æœ¬ç»™å¤§å®¶è®°å½•è½¬è´¦çš„æƒ…æ™¯ï¼Œä½ ä¼šæ€ä¹ˆåšï¼Ÿ

æ¯”ç‰¹å¸é‡‡ç”¨çš„æ–¹å¼æ˜¯è®°å½•ä¸‹æ¯ä¸€ç¬”é’±æ¯æ¬¡æ˜¯ä»å“ªé‡Œæ¥çš„ï¼Œå¾€å“ªé‡Œå»çš„ã€‚

æ¯ä¸ªäº¤æ˜“å°±æ˜¯ä¸€äº›è¾“å…¥ï¼Œä¸€äº›è¾“å‡ºï¼Œå¯èƒ½æœ‰å¤šä¸ªè¾“å…¥æˆ–è€…è¾“å‡ºã€‚

![äº¤æ˜“](./img/tx.png)

æŠŠè¿™äº›è®°å½•é“¾çŠ¶çš„è¿åœ¨ä¸€èµ·å°±èƒ½è¿½è¸ªæ¯ç¬”é’±ä»è¯ç”Ÿåˆ°ç°çŠ¶çš„æ‰€æœ‰çŠ¶æ€ï¼Œè¿™ç§é“¾çŠ¶ç»“æ„å°±å¯ä»¥åšåˆ°ã€‚

![txchain](./img/txchain.png)

è¿™ç§æ¨¡å¼ä¸‹è¦æŸ¥çœ‹è·Ÿè¸ªäº¤æ˜“å’Œç®¡ç†ä½™é¢å°±è¦ç»´æŠ¤ä¸€ä¸ªæœªèŠ±è´¹äº¤æ˜“è¾“å‡º(UTXO)ã€‚

![transaction-utxo](./img/transaction-utxo.png)


### äº¤æ˜“çš„æ ¸å¿ƒè¦ç´ 

å¦‚ä¸Šé¢ä»‹ç»çš„ï¼Œä¸€ç¬”äº¤æ˜“æœ€ä¸»è¦çš„éƒ¨åˆ†æ˜¯è¾“å…¥å’Œè¾“å‡º

åˆç”±äºæ˜¯ä¸€ä¸ªé“¾çŠ¶ç»“æ„è¾“å…¥å°±æ˜¯ä¸Šä¸€ç¬”äº¤æ˜“çš„è¾“å‡ºï¼Œè¾“å‡ºå°±æ˜¯ä¸‹ä¸€ç¬”äº¤æ˜“çš„è¾“å…¥ã€‚

è¾“å…¥è¦æŒ‡å‘å…ˆå‰äº¤æ˜“çš„è¾“å‡ºï¼Œè¯æ˜å‘é€è€…æ‹¥æœ‰è¿™äº›æ¯”ç‰¹å¸

è¾“å‡ºè¦å®šä¹‰æ¯”ç‰¹å¸çš„æ–°å½’å±ã€‚

ä¸‹é¢æˆ‘ä»¬è¯¦ç»†ä»‹ç»ä¸€ä¸‹è¾“å…¥å’Œè¾“å‡ºæ˜¯å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹çš„ã€‚

### 1. è¾“å…¥ï¼ˆInputsï¼‰

äº¤æ˜“è¾“å…¥æŒ‡å‘å…ˆå‰äº¤æ˜“çš„è¾“å‡ºï¼Œè¯æ˜å‘é€è€…æ‹¥æœ‰è¿™äº›æ¯”ç‰¹å¸ã€‚æ¯ä¸ªè¾“å…¥éƒ½åŒ…å«ä»¥ä¸‹æ ¸å¿ƒè¦ç´ ï¼š

**åŸºæœ¬ç»„æˆ**ï¼š
- **TXIDï¼ˆTransaction IDï¼‰**ï¼šæŒ‡å‘ä¹‹å‰äº¤æ˜“çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆ32å­—èŠ‚å“ˆå¸Œå€¼ï¼‰
- **VOUTï¼ˆOutput Indexï¼‰**ï¼šæŒ‡å‘è¯¥äº¤æ˜“ä¸­ç‰¹å®šè¾“å‡ºçš„ç´¢å¼•å·ï¼ˆä»0å¼€å§‹ï¼‰
- **ScriptSig**ï¼šè§£é”è„šæœ¬ï¼Œè¯æ˜å‘é€è€…æœ‰æƒä½¿ç”¨è¿™äº›èµ„é‡‘
- **Sequence**ï¼šåºåˆ—å·ï¼Œç”¨äºäº¤æ˜“æ›¿æ¢å’Œæ—¶é—´é”å®š

è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­æ¥ç†è§£è¾“å…¥ï¼š

#### æœ€ç®€å•çš„P2PKHï¼ˆPay to Public Key Hashï¼‰äº¤æ˜“è¾“å…¥

```json
{
  "txid": "a1b2c3d4e5f6...ï¼ˆçœç•¥ï¼‰",
  "vout": 0,
  "scriptSig": {
    "asm": "3044022078b3ab78a1b2c3d4...ï¼ˆæ•°å­—ç­¾åï¼‰ 0279be667ef9dcbb...ï¼ˆå…¬é’¥ï¼‰",
    "hex": "473044022078b3ab78a1b2c3d4...210279be667ef9dcbb..."
  },
  "sequence": 4294967295
}
```

**è§£é‡Š**ï¼š
- **TXIDï¼ˆäº¤æ˜“IDï¼‰**ï¼šæŒ‡å‘ä¹‹å‰äº¤æ˜“çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå°±åƒ"èº«ä»½è¯å·"ä¸€æ ·å”¯ä¸€è¯†åˆ«æ¯ç¬”äº¤æ˜“
- **VOUTï¼ˆè¾“å‡ºç´¢å¼•ï¼‰**ï¼šæŒ‡å®šè¦ä½¿ç”¨ä¸Šä¸€ç¬”äº¤æ˜“çš„ç¬¬å‡ ä¸ªè¾“å‡ºï¼ˆä»0å¼€å§‹è®¡æ•°ï¼‰
  - ä¾‹å¦‚ï¼š`vout: 0` è¡¨ç¤ºä½¿ç”¨ä¸Šä¸€ç¬”äº¤æ˜“çš„ç¬¬1ä¸ªè¾“å‡º
  - ä¾‹å¦‚ï¼š`vout: 2` è¡¨ç¤ºä½¿ç”¨ä¸Šä¸€ç¬”äº¤æ˜“çš„ç¬¬3ä¸ªè¾“å‡º
- **ScriptSigï¼ˆè§£é”è„šæœ¬ï¼‰**ï¼šè¿™æ˜¯è¯æ˜ä½ æœ‰æƒèŠ±è´¹è¿™äº›æ¯”ç‰¹å¸çš„å…³é”®éƒ¨åˆ†

#### ğŸ”‘ ScriptSig å·¥ä½œåŸç†

ScriptSigåŒ…å«æ•°å­—ç­¾åå’Œå…¬é’¥ï¼Œç”¨äºè¯æ˜ä½ å¯¹è¿™äº›æ¯”ç‰¹å¸çš„æ‰€æœ‰æƒï¼š

**å·¥ä½œåŸç†**ï¼š
1. **æ•°å­—ç­¾å**ï¼šä½¿ç”¨ç§é’¥å¯¹**å½“å‰æ–°äº¤æ˜“**çš„ä¿¡æ¯è¿›è¡Œç­¾å
2. **å…¬é’¥**ï¼šå¯¹åº”çš„å…¬é’¥ï¼Œç”¨äºéªŒè¯ç­¾å
3. **éªŒè¯è¿‡ç¨‹**ï¼šç½‘ç»œèŠ‚ç‚¹ä½¿ç”¨å…¬é’¥éªŒè¯ç­¾åæ˜¯å¦æ­£ç¡®

**âš ï¸ é‡è¦**ï¼šç­¾åçš„æ˜¯**å½“å‰è¿™ç¬”æ–°äº¤æ˜“**çš„ä¿¡æ¯ï¼Œä¸æ˜¯ä¹‹å‰äº¤æ˜“çš„ä¿¡æ¯ï¼

**ğŸ“– å…·ä½“ä¾‹å­**ï¼š
å‡è®¾Aliceè¦ç»™Bobå‘é€æ¯”ç‰¹å¸ï¼š
1. Aliceåˆ›å»ºä¸€ç¬”æ–°äº¤æ˜“ï¼š"æˆ‘è¦æŠŠä¸Šä¸€ç¬”äº¤æ˜“çš„è¾“å‡ºè½¬ç»™Bob"
2. Aliceç”¨å¥¹çš„ç§é’¥å¯¹è¿™ç¬”**æ–°äº¤æ˜“**çš„ä¿¡æ¯ç­¾å
3. ç½‘ç»œéªŒè¯ï¼šAliceçš„å…¬é’¥ç¡®å®èƒ½éªŒè¯è¿™ä¸ªç­¾å
4. ç¡®è®¤ï¼šAliceç¡®å®æœ‰æƒèŠ±è´¹è¿™äº›æ¯”ç‰¹å¸

- **Sequenceï¼ˆåºåˆ—å·ï¼‰**ï¼šé€šå¸¸è®¾ä¸ºæœ€å¤§å€¼ `4294967295`ï¼Œè¡¨ç¤ºäº¤æ˜“æœ€ç»ˆç¡®å®š
  - è¾ƒå°çš„å€¼å¯ç”¨äºRBFï¼ˆReplace-By-Feeï¼Œæ‰‹ç»­è´¹æ›¿æ¢ï¼‰
  - ä¹Ÿå¯ç”¨äºæ—¶é—´é”å®šåŠŸèƒ½

### 2. è¾“å‡ºï¼ˆOutputsï¼‰

äº¤æ˜“è¾“å‡ºå®šä¹‰äº†æ¯”ç‰¹å¸çš„æ–°å½’å±ï¼ŒæŒ‡å®šè°å¯ä»¥åœ¨æœªæ¥èŠ±è´¹è¿™äº›æ¯”ç‰¹å¸ã€‚

**åŸºæœ¬ç»„æˆ**ï¼š
- **Value**ï¼šè½¬ç§»çš„æ¯”ç‰¹å¸æ•°é‡ï¼ˆä»¥èªä¸ºå•ä½ï¼Œ1 BTC = 100,000,000 èªï¼‰
- **ScriptPubKey**ï¼šé”å®šè„šæœ¬ï¼Œå®šä¹‰äº†å¦‚ä½•æ‰èƒ½èŠ±è´¹è¿™äº›æ¯”ç‰¹å¸

è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­æ¥ç†è§£è¾“å‡ºï¼š

#### æœ€ç®€å•çš„P2PKHè¾“å‡ºï¼ˆå‘é€åˆ°æ™®é€šåœ°å€ï¼‰

```json
{
  "value": 0.01000000,
  "n": 0,
  "scriptPubKey": {
    "asm": "OP_DUP OP_HASH160 76a914...ï¼ˆ20å­—èŠ‚å…¬é’¥å“ˆå¸Œï¼‰ OP_EQUALVERIFY OP_CHECKSIG",
    "hex": "76a914762d99cb5b1c59...88ac",
    "type": "pubkeyhash",
    "address": "1BoatSLRHtKNngkdXEeobR76b53LETtpyT"
  }
}
```

**è§£é‡Š**ï¼š
- **Value**ï¼š0.01 BTCï¼ˆ1,000,000èªï¼‰ï¼Œè½¬ç§»çš„æ¯”ç‰¹å¸æ•°é‡
- **ScriptPubKey**ï¼šé”å®šè„šæœ¬ï¼Œè§„å®šäº†å¦‚ä½•èŠ±è´¹è¿™äº›æ¯”ç‰¹å¸
  - `OP_DUP OP_HASH160 ... OP_EQUALVERIFY OP_CHECKSIG`ï¼šP2PKHæ ‡å‡†è„šæœ¬
  - å«ä¹‰ï¼š"åªæœ‰èƒ½æä¾›æ­£ç¡®å…¬é’¥å’Œå¯¹åº”ç­¾åçš„äººæ‰èƒ½èŠ±è´¹è¿™äº›æ¯”ç‰¹å¸"
  - `asm`å’Œ`hex`æ˜¯åŒä¸€ä¸ªè„šæœ¬çš„ä¸¤ç§è¡¨ç°å½¢å¼:
    - `asm`ï¼šä»¥æ“ä½œç å½¢å¼æ˜¾ç¤º,æ–¹ä¾¿äººç±»é˜…è¯»(å¦‚ OP_DUP OP_HASH160)
    - `hex`ï¼šä»¥åå…­è¿›åˆ¶å½¢å¼æ˜¾ç¤º,ç”¨äºç½‘ç»œä¼ è¾“(å¦‚ 76a914...)
  - `type`ï¼šè„šæœ¬ç±»å‹ï¼Œå¦‚"pubkeyhash"è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªP2PKHè¾“å‡º
- **Address**ï¼š1å¼€å¤´çš„ä¼ ç»Ÿæ¯”ç‰¹å¸åœ°å€

> ğŸ“– **è¾“å‡ºçš„ä½œç”¨**ï¼š
> è¾“å‡ºå°±åƒç»™æ¯”ç‰¹å¸"ä¸Šé”"ï¼Œé”å®šè„šæœ¬è§„å®šäº†"è§£é”æ¡ä»¶"
> - è¿™ä¸ªä¾‹å­ä¸­ï¼šåªæœ‰æ‹¥æœ‰ç‰¹å®šç§é’¥çš„äººæ‰èƒ½è§£é”å¹¶èŠ±è´¹è¿™0.01 BTC

### 3. äº¤æ˜“å…ƒæ•°æ®

é™¤äº†è¾“å…¥è¾“å‡ºå¤–ï¼Œå®Œæ•´çš„äº¤æ˜“è¿˜åŒ…å«ï¼š
- **Version**ï¼šäº¤æ˜“ç‰ˆæœ¬å·ï¼Œå®šä¹‰äº†äº¤æ˜“æ ¼å¼çš„è§„åˆ™
- **Locktime**ï¼šé”å®šæ—¶é—´ï¼ŒæŒ‡å®šäº¤æ˜“ä½•æ—¶å¯ä»¥è¢«åŒ…å«åœ¨åŒºå—ä¸­

> â“ **å¸¸è§ç–‘é—®**ï¼šè‡ªå®šä¹‰æ•°æ®ï¼ˆç•™è¨€ã€è¯´è¯ï¼‰å­˜å‚¨åœ¨å“ªé‡Œï¼Ÿ
> 
> è‡ªå®šä¹‰æ•°æ®å­˜å‚¨åœ¨**äº¤æ˜“çš„è¾“å‡ºï¼ˆOutputsï¼‰**ä¸­ï¼Œå…·ä½“æ˜¯é€šè¿‡ä¸€ç§ç‰¹æ®Šçš„è¾“å‡ºç±»å‹â€”â€”**OP_RETURN è¾“å‡º**æ¥å®ç°ã€‚
> å…·ä½“å†…å®¹å°†åœ¨è¿›é˜¶ç¯‡ä¸­è¯¦ç»†ä»‹ç»ã€‚

## UTXOæ¨¡å‹

æ¯”ç‰¹å¸ä½¿ç”¨UTXOï¼ˆUnspent Transaction Outputï¼ŒæœªèŠ±è´¹äº¤æ˜“è¾“å‡ºï¼‰æ¨¡å‹ï¼Œè¿™ä¸ä¼ ç»Ÿé“¶è¡Œè´¦æˆ·çš„ä½™é¢æ¨¡å‹æˆªç„¶ä¸åŒï¼š

```
ä¼ ç»Ÿè´¦æˆ·æ¨¡å‹ï¼š
Aliceè´¦æˆ·: 100 BTC
Bobè´¦æˆ·: 50 BTC

UTXOæ¨¡å‹ï¼š
Aliceæ‹¥æœ‰çš„UTXO:
- UTXO1: 30 BTC (æ¥è‡ªäº¤æ˜“A)
- UTXO2: 70 BTC (æ¥è‡ªäº¤æ˜“B)
æ€»è®¡: 100 BTC

Bobæ‹¥æœ‰çš„UTXO:
- UTXO3: 50 BTC (æ¥è‡ªäº¤æ˜“C)
æ€»è®¡: 50 BTC
```

### UTXOå·¥ä½œåŸç†

1. **æ²¡æœ‰è´¦æˆ·ä½™é¢**ï¼šæ¯”ç‰¹å¸ç½‘ç»œä¸ç»´æŠ¤è´¦æˆ·ä½™é¢
2. **åªæœ‰äº¤æ˜“è¾“å‡º**ï¼šæ‰€æœ‰æ¯”ç‰¹å¸éƒ½ä»¥UTXOçš„å½¢å¼å­˜åœ¨
3. **èŠ±è´¹å³é”€æ¯**ï¼šèŠ±è´¹UTXOæ—¶ï¼Œæ•´ä¸ªUTXOè¢«é”€æ¯ï¼Œåˆ›å»ºæ–°çš„UTXO
4. **æ‰¾é›¶æœºåˆ¶**ï¼šå¦‚æœUTXOä»·å€¼å¤§äºè¦è½¬ç§»çš„é‡‘é¢ï¼Œéœ€è¦åˆ›å»ºæ‰¾é›¶è¾“å‡º

### UTXOå®é™…ä¾‹å­

å‡è®¾Aliceæœ‰ä¸€ä¸ª10 BTCçš„UTXOï¼Œæƒ³ç»™Bobè½¬5 BTCï¼š

```json
// Aliceçš„äº¤æ˜“
{
  "vin": [
    {
      "txid": "previous_tx_id",
      "vout": 0,  // Aliceçš„10 BTC UTXO
      "scriptSig": {...}  // Aliceçš„ç­¾å
    }
  ],
  "vout": [
    {
      "value": 5.0,  // ç»™Bobçš„5 BTC
      "scriptPubKey": {...}  // Bobçš„åœ°å€
    },
    {
      "value": 4.99,  // Aliceçš„æ‰¾é›¶4.99 BTC
      "scriptPubKey": {...}  // Aliceçš„æ‰¾é›¶åœ°å€
    }
    // æ³¨æ„ï¼š10 - 5 - 4.99 = 0.01 BTCä½œä¸ºçŸ¿å·¥è´¹
  ]
}
```

**ç»“æœ**ï¼š
- AliceåŸæ¥çš„10 BTC UTXOè¢«é”€æ¯
- åˆ›å»ºäº†ä¸¤ä¸ªæ–°UTXOï¼šBobçš„5 BTC + Aliceçš„4.99 BTC
- 0.01 BTCä½œä¸ºçŸ¿å·¥è´¹

## æ¯”ç‰¹å¸äº¤æ˜“çš„ç»“æ„

### äº¤æ˜“çš„æŠ€æœ¯ç»“æ„

ä¸€ç¬”æ ‡å‡†çš„æ¯”ç‰¹å¸äº¤æ˜“å…·æœ‰ä»¥ä¸‹ç»“æ„ï¼š

```
Transaction {
    version: 4å­—èŠ‚
    input_count: å˜é•¿æ•´æ•°
    inputs: [
        {
            previous_output: {
                txid: 32å­—èŠ‚
                vout: 4å­—èŠ‚
            }
            script_length: å˜é•¿æ•´æ•°
            script_sig: å˜é•¿å­—èŠ‚æ•°ç»„
            sequence: 4å­—èŠ‚
        }
        ...
    ]
    output_count: å˜é•¿æ•´æ•°
    outputs: [
        {
            value: 8å­—èŠ‚
            script_length: å˜é•¿æ•´æ•°
            script_pubkey: å˜é•¿å­—èŠ‚æ•°ç»„
        }
        ...
    ]
    locktime: 4å­—èŠ‚
}
```

### çœŸå®äº¤æ˜“ç¤ºä¾‹åˆ†æ

è®©æˆ‘ä»¬åˆ†æä¸€ç¬”çœŸå®çš„æ¯”ç‰¹å¸äº¤æ˜“ï¼š

```json
{
  "txid": "f4184fc596403b9d638783cf57adfe4c75c605f6356fbc91338530e9831e9e16",
  "version": 1,
  "locktime": 0,
  "vin": [
    {
      "txid": "0437cd7f8525ceed2324359c2d0ba26006d92d856a9c20fa0241106ee5a597c9",
      "vout": 0,
      "scriptSig": {
        "asm": "3045022100f3581e1972ae8ac7c7367a7a253bc1135223adb9a468bb3a59233f45bc578380022059af01ca17d00e41928954ac7ffe...21036873b4df35e5b6a967cf7ed4e6a9b6e0a6e2ff7c7b99ee1a8e6a4e4b1b6d6d6d",
        "hex": "483045022100f3581e1972ae8ac7c7367a7a253bc1135223adb9a468bb3a59233f45bc578380022059af01ca17d00e41928954ac7ffe...21036873b4df35e5b6a967cf7ed4e6a9b6e0a6e2ff7c7b99ee1a8e6a4e4b1b6d6d6d"
      },
      "sequence": 4294967295
    }
  ],
  "vout": [
    {
      "value": 10.00000000,
      "n": 0,
      "scriptPubKey": {
        "asm": "OP_DUP OP_HASH160 389ffce9cd9ae88dcc0631e88a821ffdbe9bfe26 OP_EQUALVERIFY OP_CHECKSIG",
        "hex": "76a914389ffce9cd9ae88dcc0631e88a821ffdbe9bfe2688ac",
        "type": "pubkeyhash",
        "address": "16CQL6VEW2RWkZ9WfGS8NhisDVZi5tCZRE"
      }
    },
    {
      "value": 40.00000000,
      "n": 1,
      "scriptPubKey": {
        "asm": "OP_DUP OP_HASH160 389ffce9cd9ae88dcc0631e88a821ffdbe9bfe26 OP_EQUALVERIFY OP_CHECKSIG",
        "hex": "76a914389ffce9cd9ae88dcc0631e88a821ffdbe9bfe2688ac",
        "type": "pubkeyhash",
        "address": "16CQL6VEW2RWkZ9WfGS8NhisDVZi5tCZRE"
      }
    }
  ]
}
```

**åˆ†æè¿™ç¬”äº¤æ˜“**ï¼š
- **ç‰ˆæœ¬å·**ï¼š1ï¼ˆåŸºç¡€äº¤æ˜“æ ¼å¼ï¼‰
- **è¾“å…¥**ï¼š1ä¸ªï¼ŒèŠ±è´¹äº†ä¹‹å‰äº¤æ˜“çš„è¾“å‡º
- **è¾“å‡º**ï¼š2ä¸ªï¼Œåˆ†åˆ«è½¬ç§»10 BTCå’Œ40 BTCåˆ°åŒä¸€ä¸ªåœ°å€
- **é”å®šæ—¶é—´**ï¼š0ï¼ˆç«‹å³ç”Ÿæ•ˆï¼‰
- **ä½¿ç”¨äº†ä¼ ç»Ÿçš„æ¯”ç‰¹å¸åœ°å€æ ¼å¼**

## äº¤æ˜“éªŒè¯åŸºç¡€

æ¯”ç‰¹å¸ç½‘ç»œä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½éœ€è¦éªŒè¯äº¤æ˜“çš„æœ‰æ•ˆæ€§ï¼Œä¸»è¦éªŒè¯ä»¥ä¸‹æ–¹é¢ï¼š

### 1. åŸºç¡€æ ¼å¼éªŒè¯
- äº¤æ˜“ç»“æ„æ˜¯å¦ç¬¦åˆåè®®è§„èŒƒ
- å­—æ®µé•¿åº¦æ˜¯å¦æ­£ç¡®
- æ•°æ®ç±»å‹æ˜¯å¦åŒ¹é…

### 2. UTXOéªŒè¯
- è¾“å…¥å¼•ç”¨çš„UTXOæ˜¯å¦å­˜åœ¨
- UTXOæ˜¯å¦å°šæœªè¢«èŠ±è´¹
- è¾“å…¥æ€»é¢æ˜¯å¦è¶³å¤Ÿ

### 3. è„šæœ¬éªŒè¯
- ScriptSigæ˜¯å¦èƒ½æ­£ç¡®è§£é”ScriptPubKey
- æ•°å­—ç­¾åæ˜¯å¦æœ‰æ•ˆ
- å…¬é’¥æ˜¯å¦ä¸åœ°å€åŒ¹é…

### 4. ç»æµè§„åˆ™éªŒè¯
- è¾“å‡ºæ€»é¢ä¸èƒ½è¶…è¿‡è¾“å…¥æ€»é¢
- çŸ¿å·¥è´¹è®¡ç®—æ˜¯å¦åˆç†
- é‡‘é¢æ˜¯å¦åœ¨æœ‰æ•ˆèŒƒå›´å†…

### éªŒè¯æµç¨‹ç¤ºä¾‹

```python
def verify_transaction(tx):
    # 1. æ ¼å¼éªŒè¯
    if not validate_format(tx):
        return False
    
    # 2. UTXOéªŒè¯
    for input in tx.inputs:
        utxo = get_utxo(input.txid, input.vout)
        if not utxo or utxo.spent:
            return False
    
    # 3. è„šæœ¬éªŒè¯
    for i, input in enumerate(tx.inputs):
        if not verify_script(input.scriptSig, utxo.scriptPubKey):
            return False
    
    # 4. ç»æµéªŒè¯
    if sum(tx.outputs) > sum(inputs):
        return False
    
    return True
```

## å®æˆ˜æ¼”ç»ƒï¼šåŸºç¡€äº¤æ˜“æ“ä½œ

### æŸ¥çœ‹UTXO

ä½¿ç”¨Bitcoin Core RPCæŸ¥çœ‹å¯ç”¨çš„UTXOï¼š

```python
import requests
import json

def bitcoin_rpc(method, params=[]):
    url = "http://localhost:8332"
    headers = {'content-type': 'application/json'}
    
    payload = {
        "method": method,
        "params": params,
        "jsonrpc": "2.0",
        "id": 0,
    }
    
    response = requests.post(url, data=json.dumps(payload), headers=headers, auth=('user', 'password'))
    return response.json()

# æŸ¥çœ‹é’±åŒ…ä¸­çš„æœªèŠ±è´¹è¾“å‡º
utxos = bitcoin_rpc("listunspent")
print("å¯ç”¨UTXO:")
for utxo in utxos['result']:
    print(f"TXID: {utxo['txid']}")
    print(f"VOUT: {utxo['vout']}")
    print(f"é‡‘é¢: {utxo['amount']} BTC")
    print(f"åœ°å€: {utxo['address']}")
    print("---")
```

### åˆ›å»ºåŸºç¡€äº¤æ˜“

```python
def create_simple_transaction():
    # 1. é€‰æ‹©è¾“å…¥UTXO
    inputs = [
        {
            "txid": "your_utxo_txid_here",
            "vout": 0
        }
    ]
    
    # 2. å®šä¹‰è¾“å‡º
    outputs = {
        "bc1qar0srrr7xfkvy5l643lydnw9re59gtzzwf5mdq": 0.001,  # æ¥æ”¶åœ°å€
        "bc1qchange_address_here": 0.0089  # æ‰¾é›¶åœ°å€
    }
    
    # 3. åˆ›å»ºåŸå§‹äº¤æ˜“
    raw_tx = bitcoin_rpc("createrawtransaction", [inputs, outputs])
    
    # 4. ç­¾åäº¤æ˜“
    signed_tx = bitcoin_rpc("signrawtransactionwithwallet", [raw_tx['result']])
    
    # 5. å¹¿æ’­äº¤æ˜“
    if signed_tx['result']['complete']:
        txid = bitcoin_rpc("sendrawtransaction", [signed_tx['result']['hex']])
        print(f"äº¤æ˜“å·²å‘é€ï¼ŒTXID: {txid['result']}")
    else:
        print("äº¤æ˜“ç­¾åå¤±è´¥")

# æ‰§è¡Œåˆ›å»ºäº¤æ˜“
create_simple_transaction()
```

## å¸¸è§é—®é¢˜

### â“ ä¸ºä»€ä¹ˆéœ€è¦æ‰¾é›¶åœ°å€ï¼Ÿ

æ¯”ç‰¹å¸ä½¿ç”¨UTXOæ¨¡å‹ï¼Œå¿…é¡»å®Œå…¨èŠ±è´¹UTXOï¼š

```
ä¾‹å­ï¼š
ä½ æœ‰ä¸€ä¸ª5 BTCçš„UTXOï¼Œæƒ³è½¬1 BTC
å¿…é¡»ï¼š
- è¾“å…¥ï¼š5 BTC UTXO
- è¾“å‡º1ï¼š1 BTC ç»™æ¥æ”¶æ–¹
- è¾“å‡º2ï¼š3.99 BTC æ‰¾é›¶ç»™è‡ªå·±
- çŸ¿å·¥è´¹ï¼š0.01 BTC
```

### â“ çŸ¿å·¥è´¹å¦‚ä½•è®¡ç®—ï¼Ÿ

çŸ¿å·¥è´¹ = è¾“å…¥æ€»é¢ - è¾“å‡ºæ€»é¢

```python
def calculate_fee(transaction):
    input_total = sum([get_utxo_value(inp.txid, inp.vout) for inp in transaction.inputs])
    output_total = sum([out.value for out in transaction.outputs])
    return input_total - output_total
```

### â“ äº¤æ˜“ç¡®è®¤éœ€è¦å¤šé•¿æ—¶é—´ï¼Ÿ

- **1ä¸ªç¡®è®¤**ï¼šçº¦10åˆ†é’Ÿï¼ˆåŒ…å«åœ¨ä¸€ä¸ªåŒºå—ä¸­ï¼‰
- **3ä¸ªç¡®è®¤**ï¼šçº¦30åˆ†é’Ÿï¼ˆè¾ƒå®‰å…¨ï¼‰
- **6ä¸ªç¡®è®¤**ï¼šçº¦60åˆ†é’Ÿï¼ˆé«˜å®‰å…¨æ€§ï¼Œäº¤æ˜“æ‰€å¸¸ç”¨ï¼‰

ç¡®è®¤æ•°é‡è¶Šå¤šï¼Œäº¤æ˜“è¢«é€†è½¬çš„å¯èƒ½æ€§è¶Šå°ã€‚

## ç»“è¯­

é€šè¿‡æœ¬ç« çš„å­¦ä¹ ï¼Œä½ å·²ç»æŒæ¡äº†æ¯”ç‰¹å¸äº¤æ˜“çš„åŸºç¡€çŸ¥è¯†ï¼š

- ç†è§£äº†äº¤æ˜“çš„è¾“å…¥ã€è¾“å‡ºç»“æ„
- æŒæ¡äº†UTXOæ¨¡å‹çš„å·¥ä½œåŸç†
- äº†è§£äº†P2PKHäº¤æ˜“çš„åŸºæœ¬æµç¨‹
- å­¦ä¼šäº†åŸºç¡€çš„äº¤æ˜“éªŒè¯æ¦‚å¿µ
- èƒ½å¤Ÿåˆ›å»ºç®€å•çš„æ¯”ç‰¹å¸äº¤æ˜“

è¿™äº›åŸºç¡€çŸ¥è¯†ä¸ºä½ è¿›ä¸€æ­¥å­¦ä¹ æ›´é«˜çº§çš„äº¤æ˜“ç±»å‹ï¼ˆå¦‚å¤šé‡ç­¾åã€SegWitã€Taprootç­‰ï¼‰æ‰“ä¸‹äº†åšå®åŸºç¡€ã€‚åœ¨ä¸‹ä¸€ç« ã€Šæ¯”ç‰¹å¸äº¤æ˜“è¿›é˜¶ã€‹ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨è¿™äº›æ›´å¤æ‚ä½†åŠŸèƒ½å¼ºå¤§çš„äº¤æ˜“æŠ€æœ¯ã€‚

---

<div align="center">
<a href="https://github.com/beihaili/Get-Started-with-Web3">ğŸ  è¿”å›ä¸»é¡µ</a> | 
<a href="https://twitter.com/bhbtc1337">ğŸ¦ å…³æ³¨ä½œè€…</a> | 
<a href="https://forms.gle/QMBwL6LwZyQew1tX8">ğŸ“ åŠ å…¥äº¤æµç¾¤</a>
</div>