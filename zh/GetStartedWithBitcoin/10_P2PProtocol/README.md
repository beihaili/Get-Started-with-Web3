# ç¬¬10è®²ï¼šP2Pç½‘ç»œåè®®

![status](https://img.shields.io/badge/çŠ¶æ€-å·²å®Œæˆ-success)
![author](https://img.shields.io/badge/ä½œè€…-beihaili-blue)
![date](https://img.shields.io/badge/æ—¥æœŸ-2025--09-orange)
![difficulty](https://img.shields.io/badge/éš¾åº¦-ä¸­çº§-yellow)

> ğŸ’¡ æ¯”ç‰¹å¸P2Pç½‘ç»œæ˜¯å»ä¸­å¿ƒåŒ–çš„æ ¸å¿ƒï¼Œè®©å…¨ä¸–ç•Œçš„èŠ‚ç‚¹èƒ½å¤Ÿåœ¨æ²¡æœ‰ä¸­å¿ƒæœåŠ¡å™¨çš„æƒ…å†µä¸‹ååŒå·¥ä½œã€‚æœ¬ç« å°†ç”¨æœ€ç›´è§‚çš„æ–¹å¼è§£é‡Šè¿™ä¸ª"æ²¡æœ‰ä¸­å¿ƒçš„ç½‘ç»œ"æ˜¯å¦‚ä½•è¿è¡Œçš„ã€‚

## ç›®å½•

- [å‰è¨€ï¼šä¸ºä»€ä¹ˆæ¯”ç‰¹å¸ä¸èƒ½ç”¨å¾®ä¿¡çš„æ–¹å¼ï¼Ÿ](#å‰è¨€ä¸ºä»€ä¹ˆæ¯”ç‰¹å¸ä¸èƒ½ç”¨å¾®ä¿¡çš„æ–¹å¼)
- [P2Pç½‘ç»œï¼šåƒæ‘åº„ä¼ è¯æ¸¸æˆ](#p2pç½‘ç»œåƒæ‘åº„ä¼ è¯æ¸¸æˆ)
- [èŠ‚ç‚¹å‘ç°ï¼šæ–°äººå¦‚ä½•èå…¥æ‘åº„](#èŠ‚ç‚¹å‘ç°æ–°äººå¦‚ä½•èå…¥æ‘åº„)
- [è¿æ¥ç®¡ç†ï¼šç»´æŒæ‘åº„å’Œè°](#è¿æ¥ç®¡ç†ç»´æŒæ‘åº„å’Œè°)
- [æ¶ˆæ¯ä¼ æ’­ï¼šæ¶ˆæ¯å¦‚ä½•ä¼ éå…¨æ‘](#æ¶ˆæ¯ä¼ æ’­æ¶ˆæ¯å¦‚ä½•ä¼ éå…¨æ‘)
- [å®‰å…¨å‡çº§ï¼šç»™ä¼ è¯åŠ å¯†](#å®‰å…¨å‡çº§ç»™ä¼ è¯åŠ å¯†)
- [åŠ¨æ‰‹å®è·µï¼šè¿æ¥æ¯”ç‰¹å¸ç½‘ç»œ](#åŠ¨æ‰‹å®è·µè¿æ¥æ¯”ç‰¹å¸ç½‘ç»œ)
- [å¸¸è§é—®é¢˜è§£ç­”](#å¸¸è§é—®é¢˜è§£ç­”)

## å‰è¨€ï¼šä¸ºä»€ä¹ˆæ¯”ç‰¹å¸ä¸èƒ½ç”¨å¾®ä¿¡çš„æ–¹å¼ï¼Ÿ

æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœå¾®ä¿¡æ²¡æœ‰è…¾è®¯å…¬å¸çš„æœåŠ¡å™¨ä¼šæ€æ ·ï¼Ÿ

**å¾®ä¿¡çš„ç°å®ï¼š**
- ä½ å‘æ¶ˆæ¯ â†’ è…¾è®¯æœåŠ¡å™¨ â†’ æœ‹å‹æ”¶åˆ°æ¶ˆæ¯
- å¦‚æœè…¾è®¯æœåŠ¡å™¨å®•æœº â†’ å…¨ä¸–ç•Œå¾®ä¿¡éƒ½ä¸èƒ½ç”¨
- å¦‚æœæ”¿åºœå…³é—­è…¾è®¯ â†’ å¾®ä¿¡å½»åº•æ¶ˆå¤±

**ä½†æ¯”ç‰¹å¸åšåˆ°äº†ä¸å¯èƒ½çš„äº‹æƒ…ï¼š**
- å…¨çƒ13,000ä¸ªèŠ‚ç‚¹ï¼Œæ²¡æœ‰æ€»éƒ¨ï¼Œæ²¡æœ‰CEO
- 24å°æ—¶ä¸é—´æ–­å¤„ç†äº¤æ˜“ï¼Œä»æœªåœæœº
- ä»»ä½•æ”¿åºœéƒ½æ— æ³•å…³é—­æ•´ä¸ªç½‘ç»œ

è¿™ä¸ª"ä¸å¯èƒ½"æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿç­”æ¡ˆå°±åœ¨P2Pï¼ˆç‚¹å¯¹ç‚¹ï¼‰ç½‘ç»œåè®®ä¸­ã€‚

### ğŸ’¡ æ€è€ƒä¸€ä¸‹
åœ¨å­¦ä¹ P2Pç½‘ç»œä¹‹å‰ï¼Œå…ˆæƒ³æƒ³ï¼š
- å¦‚æœä½ åœ¨ä¸€ä¸ªæ²¡æœ‰æ‘é•¿çš„æ‘åº„ï¼Œå¦‚ä½•è®©å…¨æ‘äººéƒ½çŸ¥é“ä¸€ä»¶äº‹ï¼Ÿ
- å¦‚æœæ²¡æœ‰é‚®å±€ï¼Œä½ æ€ä¹ˆç»™è¿œæ–¹çš„æœ‹å‹é€ä¿¡ï¼Ÿ
- å¦‚æœæ²¡æœ‰ç”µè¯å…¬å¸ï¼Œå¤§å®¶æ€ä¹ˆä¿æŒè”ç³»ï¼Ÿ

## P2Pç½‘ç»œï¼šåƒæ‘åº„ä¼ è¯æ¸¸æˆ

### ä¸­å¿ƒåŒ– vs å»ä¸­å¿ƒåŒ–

**ä¸­å¿ƒåŒ–ç½‘ç»œï¼ˆå¾®ä¿¡æ¨¡å¼ï¼‰ï¼š**
```
ç”¨æˆ·A â†’ è…¾è®¯æœåŠ¡å™¨ â† ç”¨æˆ·B
         â†‘
    å•ç‚¹æ•…éšœé£é™©
```
å°±åƒä¸€ä¸ªæ‘åº„åªæœ‰æ‘é•¿ä¸€ä¸ªäººè´Ÿè´£ä¼ è¯ï¼Œæ‘é•¿ç”Ÿç—…äº†ï¼Œå…¨æ‘éƒ½æ— æ³•äº¤æµã€‚

**P2Pç½‘ç»œï¼ˆæ¯”ç‰¹å¸æ¨¡å¼ï¼‰ï¼š**
```
èŠ‚ç‚¹A â†” èŠ‚ç‚¹B â†” èŠ‚ç‚¹C
 â†•       â†•       â†•  
èŠ‚ç‚¹D â†” èŠ‚ç‚¹E â†” èŠ‚ç‚¹F
   æ²¡æœ‰æ‘é•¿ï¼Œç…§æ ·ä¼ è¯
```
å°±åƒæ‘æ°‘ä¹‹é—´ç›´æ¥äº¤æµï¼Œä»»ä½•å‡ ä¸ªæ‘æ°‘ç¦»å¼€éƒ½ä¸å½±å“å…¶ä»–äººç»§ç»­æ²Ÿé€šã€‚

### ç½‘ç»œçš„ç¥å¥‡ç‰¹æ€§

**æ¯”ç‰¹å¸P2Pç½‘ç»œå°±åƒä¸€ä¸ªç†æƒ³æ‘åº„ï¼š**
- ğŸ˜ï¸ **å¹³ç­‰æ€§**ï¼šæ¯ä¸ªæ‘æ°‘éƒ½æ˜¯å¹³ç­‰çš„ï¼Œæ²¡æœ‰"æ‘é•¿"
- ğŸ”„ **å®¹é”™æ€§**ï¼šä»»ä½•æ‘æ°‘ç¦»å¼€éƒ½ä¸å½±å“æ•´ä¸ªæ‘åº„
- ğŸš« **æŠ—å®¡æŸ¥**ï¼šæ²¡æœ‰ä¸­å¿ƒç‚¹å¯ä»¥è¢«å…³é—­
- ğŸ¤ **è‡ªç»„ç»‡**ï¼šæ‘æ°‘ä¼šè‡ªåŠ¨ç»´æŠ¤å’Œä¼˜åŒ–å…³ç³»

**è¿æ¥ç­–ç•¥ï¼ˆæ‘æ°‘çš„ç¤¾äº¤è§„åˆ™ï¼‰ï¼š**
- æ¯ä¸ªæ‘æ°‘ä¸»åŠ¨è”ç³»8ä¸ªæœ‹å‹ï¼ˆå‡ºç«™è¿æ¥ï¼‰
- åŒæ—¶æ¥å—æœ€å¤š125ä¸ªæœ‹å‹çš„è”ç³»ï¼ˆå…¥ç«™è¿æ¥ï¼‰  
- é»˜è®¤åœ¨8333ç«¯å£"å¼€é—¨è¿å®¢"

## èŠ‚ç‚¹å‘ç°ï¼šæ–°äººå¦‚ä½•èå…¥æ‘åº„

æ–°èŠ‚ç‚¹åŠ å…¥ç½‘ç»œé¢ä¸´"é¸¡ç”Ÿè›‹"é—®é¢˜ï¼šéœ€è¦çŸ¥é“å…¶ä»–èŠ‚ç‚¹çš„åœ°å€æ‰èƒ½è¿æ¥ï¼Œä½†å¦‚ä½•è·å¾—ç¬¬ä¸€ä¸ªæœ‹å‹çš„è”ç³»æ–¹å¼ï¼Ÿ

### ç¬¬ä¸€æ­¥ï¼šæŸ¥ç”µè¯é»„é¡µï¼ˆDNSç§å­ï¼‰

æ¯”ç‰¹å¸å°±åƒç»™æ–°æ‘æ°‘å‡†å¤‡äº†9æœ¬"ç”µè¯é»„é¡µ"ï¼š

**ğŸ” DNSç§å­å‘ç°è¿‡ç¨‹ï¼š**
1. **æŸ¥è¯¢ç”µè¯é»„é¡µ**ï¼šæ–°èŠ‚ç‚¹å‘9ä¸ªDNSæœåŠ¡å™¨è¯·æ±‚æ´»è·ƒèŠ‚ç‚¹åˆ—è¡¨
2. **è·å¾—è”ç³»æ–¹å¼**ï¼šæ¯ä¸ªé»„é¡µè¿”å›5-20ä¸ªå¯é æœ‹å‹çš„IPåœ°å€
3. **å°è¯•è¿æ¥**ï¼šæ–°èŠ‚ç‚¹ä¾æ¬¡è”ç³»è¿™äº›åœ°å€ï¼Œå»ºç«‹ç¬¬ä¸€æ‰¹å‹è°Š

**ğŸ“ æ¯”ç‰¹å¸çš„9æœ¬"ç”µè¯é»„é¡µ"ï¼š**
- `seed.bitcoin.sipa.be` - Pieterç»´æŠ¤çš„æƒå¨é»„é¡µ
- `dnsseed.bluematt.me` - Mattçš„ç¤¾åŒºé»„é¡µ  
- `seed.bitcoinstats.com` - ç»Ÿè®¡ç½‘ç«™çš„é»„é¡µ
- ï¼ˆè¿˜æœ‰å¦å¤–6ä¸ªåˆ†å¸ƒå…¨çƒçš„å¤‡ç”¨é»„é¡µï¼‰

**ç”µè¯é»„é¡µçš„ä¼˜åŠ¿ï¼š**
- ğŸ¢ **ç‹¬ç«‹ç»´æŠ¤**ï¼š9ä¸ªä¸åŒçš„äººç»´æŠ¤ï¼Œä¸ä¼šåŒæ—¶å¤±æ•ˆ
- ğŸ”„ **è‡ªåŠ¨æ›´æ–°**ï¼šåªè¿”å›æœ€è¿‘æ´»è·ƒçš„èŠ‚ç‚¹åœ°å€
- ğŸŒ **å…¨çƒåˆ†å¸ƒ**ï¼šåˆ†å¸ƒåœ¨ä¸åŒå›½å®¶ï¼ŒæŠ—å•ç‚¹æ•…éšœ

### ç¬¬äºŒæ­¥ï¼šæœ‹å‹ä»‹ç»æœ‹å‹ï¼ˆåœ°å€ä¼ æ’­ï¼‰

ä¸€æ—¦è¿æ¥åˆ°ç¬¬ä¸€ä¸ªæœ‹å‹ï¼Œå‘ç°æ›´å¤šæœ‹å‹å°±å˜å¾—ç®€å•ï¼š

```
æ–°æ‘æ°‘ â†’ è¿æ¥æ‘æ°‘A â†’ "å—¨ï¼Œä½ è¿˜è®¤è¯†è°ï¼Ÿ"
æ‘æ°‘A â†’ "æˆ‘è®¤è¯†æ‘æ°‘Bã€Cã€Dï¼Œç»™ä½ ä»–ä»¬çš„è”ç³»æ–¹å¼"
æ–°æ‘æ°‘ â†’ è¿æ¥æ‘æ°‘B â†’ "ä½ è¿˜è®¤è¯†å…¶ä»–äººå—ï¼Ÿ"
æ‘æ°‘B â†’ "æˆ‘è®¤è¯†æ‘æ°‘Eã€Fã€G..."
```

è¿™å°±åƒæ»šé›ªçƒä¸€æ ·ï¼Œæœ‹å‹åœˆè¶Šæ¥è¶Šå¤§ï¼

### ç¬¬ä¸‰æ­¥ï¼šå»ºç«‹é€šè®¯å½•ï¼ˆæŒä¹…åŒ–å­˜å‚¨ï¼‰

èªæ˜çš„æ‘æ°‘ä¼šæŠŠæœ‹å‹çš„è”ç³»æ–¹å¼è®°åœ¨å°æœ¬æœ¬ä¸Šï¼š

```python
class BitcoinAddressBook:
    def __init__(self):
        self.trusted_friends = []    # éªŒè¯è¿‡çš„å¯é æœ‹å‹
        self.potential_friends = []  # å¬è¯´è¿‡ä½†è¿˜æ²¡è”ç³»çš„æœ‹å‹
    
    def save_friend(self, friend_address):
        """æŠŠæœ‹å‹çš„è”ç³»æ–¹å¼è®°å½•ä¸‹æ¥"""
        if self.test_connection(friend_address):
            self.trusted_friends.append(friend_address)
            print(f"âœ… {friend_address} æ˜¯å¯é çš„æœ‹å‹ï¼Œå·²ä¿å­˜")
        else:
            self.potential_friends.append(friend_address)
            print(f"ğŸ“ {friend_address} å…ˆè®°ä¸‹æ¥ï¼Œä»¥åå†è”ç³»")
    
    def load_address_book(self):
        """ä¸‹æ¬¡å¯åŠ¨æ—¶ï¼Œç›´æ¥ä»é€šè®¯å½•æ‰¾æœ‹å‹"""
        print("ğŸ“– ç¿»å¼€é€šè®¯å½•ï¼Œå¯»æ‰¾è€æœ‹å‹...")
        return self.trusted_friends
```

## è¿æ¥ç®¡ç†ï¼šç»´æŒæ‘åº„å’Œè°

### äº¤æœ‹å‹çš„æ™ºæ…§

æ¯”ç‰¹å¸èŠ‚ç‚¹å°±åƒä¸€ä¸ªå–„äºç¤¾äº¤çš„æ‘æ°‘ï¼Œæœ‰ä¸€å¥—å®Œæ•´çš„"äº¤å‹ç­–ç•¥"ï¼š

**ä¸»åŠ¨äº¤å‹ï¼ˆ8ä¸ªå‡ºç«™è¿æ¥ï¼‰ï¼š**
- ä¸»åŠ¨å¯»æ‰¾å¹¶è”ç³»8ä¸ªæœ‹å‹
- ä¼˜å…ˆè”ç³»é€šè®¯å½•é‡Œçš„å¯é æœ‹å‹
- å¦‚æœè€æœ‹å‹è”ç³»ä¸ä¸Šï¼Œå°±å¯»æ‰¾æ–°æœ‹å‹

**è¢«åŠ¨äº¤å‹ï¼ˆ125ä¸ªå…¥ç«™è¿æ¥ï¼‰ï¼š**
- æ¥å—å…¶ä»–æ‘æ°‘çš„è”ç³»è¯·æ±‚
- ä½†ä¸èƒ½æ¥è€…ä¸æ‹’ï¼Œè¦é˜²æ­¢æ¶æ„éªšæ‰°
- ç»´æŒä¸€ä¸ªåˆç†çš„ç¤¾äº¤åœˆå­

### æœ‹å‹åœˆçš„å¤šæ ·æ€§

èªæ˜çš„æ‘æ°‘ä¸ä¼šåªå’Œé‚»å±…åšæœ‹å‹ï¼š

```python
def choose_diverse_friends(potential_friends):
    """é€‰æ‹©å¤šæ ·åŒ–çš„æœ‹å‹åœˆ"""
    selected_friends = []
    
    # åœ°ç†å¤šæ ·æ€§ï¼šä¸è¦éƒ½æ˜¯åŒä¸€ä¸ªå°åŒºçš„
    regions = {}
    for friend in potential_friends:
        region = get_network_region(friend)
        if region not in regions:
            regions[region] = []
        regions[region].append(friend)
    
    # æ¯ä¸ªåœ°åŒºæœ€å¤šé€‰2ä¸ªæœ‹å‹
    for region, friends in regions.items():
        selected_friends.extend(friends[:2])
        print(f"ä» {region} åœ°åŒºé€‰æ‹©äº† {min(2, len(friends))} ä¸ªæœ‹å‹")
    
    return selected_friends[:8]  # æ€»å…±8ä¸ªæœ‹å‹
```

**å¤šæ ·æ€§çš„å¥½å¤„ï¼š**
- ğŸŒ **åœ°ç†åˆ†å¸ƒ**ï¼šé¿å…éƒ½æ˜¯åŒä¸€åœ°åŒºçš„æœ‹å‹
- ğŸ”„ **ç‰ˆæœ¬å…¼å®¹**ï¼šæ–°è€ç‰ˆæœ¬çš„æœ‹å‹éƒ½è¦æœ‰
- â° **æ—¶é—´åˆ†æ•£**ï¼šä¸åŒæ—¶é—´ä¸Šçº¿çš„æœ‹å‹

### å¥åº·æ£€æŸ¥ï¼šä¿æŒå‹è°Šæ–°é²œ

æ‘æ°‘ä¹‹é—´å®šæœŸé—®å€™ï¼Œç¡®ä¿å‹è°Šé•¿å­˜ï¼š

```python
def keep_friendship_alive():
    """å®šæœŸé—®å€™æœ‹å‹ï¼Œä¿æŒè”ç³»"""
    for friend in my_friends:
        # æ¯90ç§’å‘ä¸ª"ä½ å¥½"
        send_ping(friend, "å—¨ï¼Œä½ è¿˜åœ¨å—ï¼Ÿ")
        
        # ç­‰å¾…å›å¤
        response = wait_for_pong(friend, timeout=30)
        
        if response:
            print(f"âœ… {friend} å›å¤äº†ï¼šä¸€åˆ‡éƒ½å¥½ï¼")
            update_friend_status(friend, "åœ¨çº¿")
        else:
            print(f"âŒ {friend} æ²¡æœ‰å›å¤ï¼Œå¯èƒ½ç¦»çº¿äº†")
            find_new_friend_to_replace(friend)
```

## æ¶ˆæ¯ä¼ æ’­ï¼šæ¶ˆæ¯å¦‚ä½•ä¼ éå…¨æ‘

### æ‘åº„å¹¿æ’­ç³»ç»Ÿ

æ¯”ç‰¹å¸ç½‘ç»œå°±åƒä¸€ä¸ªé«˜æ•ˆçš„æ‘åº„å¹¿æ’­ç³»ç»Ÿï¼Œä½†æ²¡æœ‰å¹¿æ’­ç«™ï¼š

**ä¼ ç»Ÿå¹¿æ’­ï¼š**
```
æ‘æ°‘A â†’ å¹¿æ’­ç«™ â†’ å…¨æ‘æ”¶å¬
        â†‘
   å•ç‚¹æ•…éšœé£é™©
```

**æ¯”ç‰¹å¸å¼ä¼ æ’­ï¼š**
```
æ‘æ°‘A â†’ å‘Šè¯‰æœ‹å‹ä»¬ â†’ æœ‹å‹ä»¬å†å‘Šè¯‰ä»–ä»¬çš„æœ‹å‹ â†’ æ¶ˆæ¯ä¼ éå…¨æ‘
```

### æ™ºèƒ½ä¼ æ’­ç­–ç•¥

ä¸ºäº†é¿å…"ä¼ è¯æ¸¸æˆ"å˜æˆæ··ä¹±ï¼Œæ¯”ç‰¹å¸è®¾è®¡äº†èªæ˜çš„ä¼ æ’­æœºåˆ¶ï¼š

```python
def spread_news_efficiently(news):
    """é«˜æ•ˆä¼ æ’­æ¶ˆæ¯çš„æ–¹æ³•"""
    
    # ç¬¬1æ­¥ï¼šåˆ¶ä½œæ¶ˆæ¯æ‘˜è¦
    news_summary = create_summary(news)  # "æˆ‘æœ‰ä¸€ä¸ªé‡è¦æ¶ˆæ¯"
    
    # ç¬¬2æ­¥ï¼šå…ˆå‘æ‘˜è¦ç»™æœ‹å‹ä»¬
    for friend in my_friends:
        send_message(friend, {
            "type": "æˆ‘æœ‰æ¶ˆæ¯",
            "summary": news_summary,
            "full_news": None  # å…ˆä¸å‘å®Œæ•´æ¶ˆæ¯
        })
    
    # ç¬¬3æ­¥ï¼šæœ‹å‹ä»¬ä¼šé—®"ä»€ä¹ˆæ¶ˆæ¯ï¼Ÿ"
    def handle_friend_request(friend, request):
        if request.type == "å‘Šè¯‰æˆ‘è¯¦æƒ…":
            send_message(friend, {
                "type": "å®Œæ•´æ¶ˆæ¯",
                "content": news  # ç°åœ¨å‘å®Œæ•´æ¶ˆæ¯
            })
    
    # ç¬¬4æ­¥ï¼šæœ‹å‹æ”¶åˆ°åï¼Œç»§ç»­ä¼ æ’­ç»™ä»–ä»¬çš„æœ‹å‹
    print("ğŸ“¢ æ¶ˆæ¯å¼€å§‹åœ¨æ‘åº„é‡Œä¼ æ’­...")
```

**ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿ**
- ğŸ’¾ **èŠ‚çœå¸¦å®½**ï¼šå…ˆå‘æ‘˜è¦ï¼Œéœ€è¦çš„äººå†è¦è¯¦æƒ…
- ğŸš« **é¿å…é‡å¤**ï¼šæ¯ä¸ªäººéƒ½è®°ä½å¬è¿‡çš„æ¶ˆæ¯ï¼Œä¸é‡å¤ä¼ æ’­
- âš¡ **å¿«é€Ÿä¼ æ’­**ï¼šå¹³å‡12ç§’å°±èƒ½ä¼ é95%çš„ç½‘ç»œ

### æ¶ˆæ¯æ ¼å¼ï¼šæ‘åº„çš„"æ™®é€šè¯"

æ‰€æœ‰æ‘æ°‘éƒ½ä½¿ç”¨ç»Ÿä¸€çš„"æ™®é€šè¯"æ ¼å¼ï¼š

```python
def create_bitcoin_message(message_type, content):
    """åˆ›å»ºæ ‡å‡†çš„æ¯”ç‰¹å¸æ¶ˆæ¯"""
    # æ‘åº„çš„"æ–¹è¨€æ ‡è¯†"
    magic_word = b'\xf9\xbe\xb4\xd9'  # ä¸»ç½‘çš„é­”æ³•æ•°å­—
    
    # æ¶ˆæ¯ç±»å‹ï¼ˆæœ€å¤š12ä¸ªå­—ç¬¦ï¼‰
    command = message_type.ljust(12, b'\x00')[:12]
    
    # æ¶ˆæ¯é•¿åº¦
    length = len(content)
    
    # æ¶ˆæ¯"ç­¾å"ï¼ˆé˜²æ­¢ä¼ è¯å¤±çœŸï¼‰
    signature = hashlib.sha256(hashlib.sha256(content).digest()).digest()[:4]
    
    # ç»„è£…å®Œæ•´æ¶ˆæ¯
    full_message = magic_word + command + length.to_bytes(4, 'little') + signature + content
    
    return full_message

# ç¤ºä¾‹ï¼šåˆ›å»ºä¸€ä¸ª"æ‰“æ‹›å‘¼"æ¶ˆæ¯
greeting = create_bitcoin_message(b'version', b'Hello, Bitcoin network!')
print(f"æ¶ˆæ¯é•¿åº¦ï¼š{len(greeting)} å­—èŠ‚")
```

## å®‰å…¨å‡çº§ï¼šç»™ä¼ è¯åŠ å¯†

### æ˜æ–‡ä¼ è¯çš„é£é™©

ä»¥å‰æ‘æ°‘ä¹‹é—´ä¼ è¯éƒ½æ˜¯æ˜æ–‡çš„ï¼Œå°±åƒå¤§å£°å–Šè¯ï¼š

```
æ‘æ°‘A å¤§å£°å–Šï¼š"æˆ‘è¦ç»™æ‘æ°‘Bè½¬è´¦1ä¸ªæ¯”ç‰¹å¸ï¼"
å·å¬è€… çªƒç¬‘ï¼š"å˜¿å˜¿ï¼Œæˆ‘çŸ¥é“äº†Açš„è´¢åŠ¡çŠ¶å†µ..."
```

è¿™æ ·æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ
- ğŸ•µï¸ **éšç§æ³„éœ²**ï¼šåˆ«äººèƒ½å¬åˆ°ä½ çš„æ‰€æœ‰å¯¹è¯
- ğŸ­ **èº«ä»½æš´éœ²**ï¼šå®¹æ˜“è¢«è¿½è¸ªå’Œåˆ†æ
- ğŸ” **æµé‡åˆ†æ**ï¼šæ”¿åºœå¯èƒ½ç›‘æ§ç½‘ç»œæµé‡

### BIP 324ï¼šç»™ä¼ è¯åŠ å¯†

2024å¹´ï¼Œæ¯”ç‰¹å¸ç½‘ç»œå¼€å§‹ä½¿ç”¨"åŠ å¯†ä¼ è¯"ï¼š

```python
class SecretTalk:
    def __init__(self):
        self.my_secret_key = generate_random_key()  # æˆ‘çš„å¯†é’¥
        self.friend_public_key = None               # æœ‹å‹çš„å…¬é’¥
        self.shared_secret = None                   # å…±åŒç§˜å¯†
    
    def establish_secret_channel(self, friend):
        """å’Œæœ‹å‹å»ºç«‹åŠ å¯†é€šé“"""
        
        # ç¬¬1æ­¥ï¼šäº¤æ¢å…¬é’¥ï¼ˆåƒäº¤æ¢æš—å·ï¼‰
        my_public_key = derive_public_key(self.my_secret_key)
        send_to_friend(friend, my_public_key)
        self.friend_public_key = receive_from_friend(friend)
        
        # ç¬¬2æ­¥ï¼šç”Ÿæˆå…±åŒç§˜å¯†ï¼ˆæ•°å­¦é­”æ³•ï¼‰
        self.shared_secret = calculate_shared_secret(
            self.my_secret_key, 
            self.friend_public_key
        )
        
        print("âœ… åŠ å¯†é€šé“å·²å»ºç«‹ï¼ç°åœ¨å¯ä»¥æ‚„æ‚„è¯äº†")
    
    def send_secret_message(self, friend, message):
        """å‘é€åŠ å¯†æ¶ˆæ¯"""
        # ç”¨å…±åŒç§˜å¯†åŠ å¯†æ¶ˆæ¯
        encrypted_message = encrypt_with_secret(message, self.shared_secret)
        send_to_friend(friend, encrypted_message)
        print(f"ğŸ” å·²å‘é€åŠ å¯†æ¶ˆæ¯ç»™ {friend}")
    
    def receive_secret_message(self, encrypted_message):
        """æ¥æ”¶åŠ å¯†æ¶ˆæ¯"""
        # ç”¨å…±åŒç§˜å¯†è§£å¯†æ¶ˆæ¯
        original_message = decrypt_with_secret(encrypted_message, self.shared_secret)
        print(f"ğŸ“¨ æ”¶åˆ°è§£å¯†æ¶ˆæ¯ï¼š{original_message}")
        return original_message
```

**åŠ å¯†çš„å¥½å¤„ï¼š**
- ğŸ›¡ï¸ **éšç§ä¿æŠ¤**ï¼šå¤–äººæ— æ³•å·å¬å¯¹è¯å†…å®¹
- ğŸ”’ **é˜²ç¯¡æ”¹**ï¼šæ¶ˆæ¯è¢«ä¿®æ”¹ä¼šè¢«å‘ç°
- ğŸ”‘ **å‰å‘å®‰å…¨**ï¼šå³ä½¿å¯†é’¥æ³„éœ²ï¼Œä¹‹å‰çš„å¯¹è¯ä»ç„¶å®‰å…¨
- ğŸ”„ **å‘åå…¼å®¹**ï¼šè¿˜èƒ½å’Œä½¿ç”¨è€æ–¹å¼çš„æœ‹å‹äº¤æµ

## åŠ¨æ‰‹å®è·µï¼šè¿æ¥æ¯”ç‰¹å¸ç½‘ç»œ

### å‡†å¤‡å·¥ä½œï¼šå®‰è£…æ¯”ç‰¹å¸å®¢æˆ·ç«¯

```bash
# ä¸‹è½½å¹¶å®‰è£…Bitcoin Core
# è®¿é—® https://bitcoin.org/en/download

# æˆ–è€…ä½¿ç”¨åŒ…ç®¡ç†å™¨ï¼ˆMacï¼‰
brew install bitcoin

# æˆ–è€…ä½¿ç”¨åŒ…ç®¡ç†å™¨ï¼ˆUbuntuï¼‰
sudo apt-get install bitcoin
```

### ç¬¬ä¸€æ­¥ï¼šå¯åŠ¨ä½ çš„æ¯”ç‰¹å¸èŠ‚ç‚¹

```bash
# å¯åŠ¨æ¯”ç‰¹å¸èŠ‚ç‚¹ï¼ˆæµ‹è¯•ç½‘ç»œï¼‰
bitcoind -testnet -daemon

# ç­‰å¾…å‡ ç§’é’Ÿï¼Œè®©èŠ‚ç‚¹å¯åŠ¨
sleep 5

# æ£€æŸ¥èŠ‚ç‚¹æ˜¯å¦æ­£å¸¸è¿è¡Œ
bitcoin-cli -testnet getnetworkinfo
```

### ç¬¬äºŒæ­¥ï¼šæŸ¥çœ‹ä½ çš„æœ‹å‹åœˆ

```bash
# æŸ¥çœ‹è¿æ¥äº†å¤šå°‘ä¸ªæœ‹å‹
bitcoin-cli -testnet getconnectioncount

# æŸ¥çœ‹æœ‹å‹ä»¬çš„è¯¦ç»†ä¿¡æ¯
bitcoin-cli -testnet getpeerinfo | head -20
```

ä½ ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„è¾“å‡ºï¼š
```json
{
  "id": 1,
  "addr": "192.168.1.100:18333",
  "version": 70016,
  "subver": "/Satoshi:25.0.0/",
  "inbound": false,
  "bip152_hb_to": true,
  "bip324": true
}
```

### ç¬¬ä¸‰æ­¥ï¼šè§‚å¯Ÿæ¶ˆæ¯ä¼ æ’­

```python
#!/usr/bin/env python3
"""
ç®€å•çš„æ¯”ç‰¹å¸ç½‘ç»œç›‘å¬å™¨
è§‚å¯ŸP2Pæ¶ˆæ¯çš„ä¼ æ’­
"""

import socket
import struct
import hashlib
import time

class BitcoinNetworkListener:
    def __init__(self, host='127.0.0.1', port=18333):
        self.host = host
        self.port = port
        self.socket = None
    
    def connect_to_node(self):
        """è¿æ¥åˆ°æœ¬åœ°æ¯”ç‰¹å¸èŠ‚ç‚¹"""
        try:
            self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            self.socket.connect((self.host, self.port))
            print(f"âœ… æˆåŠŸè¿æ¥åˆ° {self.host}:{self.port}")
            return True
        except Exception as e:
            print(f"âŒ è¿æ¥å¤±è´¥: {e}")
            return False
    
    def send_version_message(self):
        """å‘é€ç‰ˆæœ¬æ¶ˆæ¯ï¼Œè¿›è¡Œæ¡æ‰‹"""
        # è¿™é‡Œæ˜¯ç®€åŒ–ç‰ˆæœ¬ï¼Œå®é™…å®ç°æ›´å¤æ‚
        version_payload = struct.pack('<I', 70015)  # åè®®ç‰ˆæœ¬
        magic = b'\x0b\x11\x09\x07'  # æµ‹è¯•ç½‘é­”æ³•æ•°å­—
        command = b'version'.ljust(12, b'\x00')
        length = len(version_payload)
        checksum = hashlib.sha256(hashlib.sha256(version_payload).digest()).digest()[:4]
        
        message = magic + command + struct.pack('<I', length) + checksum + version_payload
        self.socket.send(message)
        print("ğŸ“¤ å·²å‘é€ç‰ˆæœ¬æ¶ˆæ¯")
    
    def listen_for_messages(self):
        """ç›‘å¬ç½‘ç»œæ¶ˆæ¯"""
        print("ğŸ‘‚ å¼€å§‹ç›‘å¬P2Pæ¶ˆæ¯...")
        
        while True:
            try:
                data = self.socket.recv(1024)
                if data:
                    self.parse_message(data)
                time.sleep(1)
            except KeyboardInterrupt:
                print("\nğŸ›‘ åœæ­¢ç›‘å¬")
                break
    
    def parse_message(self, data):
        """è§£ææ”¶åˆ°çš„æ¶ˆæ¯"""
        if len(data) >= 24:  # æ¶ˆæ¯å¤´æœ€å°‘24å­—èŠ‚
            magic = data[:4]
            command = data[4:16].rstrip(b'\x00').decode('ascii', errors='ignore')
            length = struct.unpack('<I', data[16:20])[0]
            
            print(f"ğŸ“¨ æ”¶åˆ°æ¶ˆæ¯: {command}, é•¿åº¦: {length} å­—èŠ‚")

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    listener = BitcoinNetworkListener()
    if listener.connect_to_node():
        listener.send_version_message()
        listener.listen_for_messages()
```

### ç¬¬å››æ­¥ï¼šæµ‹è¯•ç½‘ç»œè¿æ¥

```bash
# åˆ›å»ºä¸€ä¸ªç®€å•çš„æµ‹è¯•è„šæœ¬
cat > test_p2p.py << 'EOF'
#!/usr/bin/env python3
import subprocess
import json

def test_bitcoin_network():
    """æµ‹è¯•æ¯”ç‰¹å¸ç½‘ç»œè¿æ¥"""
    
    print("ğŸ” æµ‹è¯•æ¯”ç‰¹å¸P2Pç½‘ç»œè¿æ¥...\n")
    
    # æµ‹è¯•1ï¼šæ£€æŸ¥ç½‘ç»œçŠ¶æ€
    print("ğŸ“Š ç½‘ç»œçŠ¶æ€:")
    result = subprocess.run(['bitcoin-cli', '-testnet', 'getnetworkinfo'], 
                          capture_output=True, text=True)
    if result.returncode == 0:
        info = json.loads(result.stdout)
        print(f"  ç‰ˆæœ¬: {info['version']}")
        print(f"  è¿æ¥æ•°: {info['connections']}")
        print(f"  ç½‘ç»œ: {info['networkactive']}")
        print(f"  åè®®ç‰ˆæœ¬: {info['protocolversion']}")
    
    # æµ‹è¯•2ï¼šæ£€æŸ¥å¯¹ç­‰èŠ‚ç‚¹
    print("\nğŸ‘¥ å¯¹ç­‰èŠ‚ç‚¹ä¿¡æ¯:")
    result = subprocess.run(['bitcoin-cli', '-testnet', 'getpeerinfo'], 
                          capture_output=True, text=True)
    if result.returncode == 0:
        peers = json.loads(result.stdout)
        for i, peer in enumerate(peers[:3]):  # åªæ˜¾ç¤ºå‰3ä¸ª
            print(f"  èŠ‚ç‚¹{i+1}: {peer['addr']} (ç‰ˆæœ¬: {peer['version']})")
    
    # æµ‹è¯•3ï¼šæ£€æŸ¥åŒºå—é“¾åŒæ­¥çŠ¶æ€
    print("\nâ›“ï¸  åŒºå—é“¾åŒæ­¥çŠ¶æ€:")
    result = subprocess.run(['bitcoin-cli', '-testnet', 'getblockchaininfo'], 
                          capture_output=True, text=True)
    if result.returncode == 0:
        info = json.loads(result.stdout)
        print(f"  å½“å‰åŒºå—: {info['blocks']}")
        print(f"  éªŒè¯è¿›åº¦: {info['verificationprogress']:.2%}")

if __name__ == "__main__":
    test_bitcoin_network()
EOF

# è¿è¡Œæµ‹è¯•
python3 test_p2p.py
```

## å¸¸è§é—®é¢˜è§£ç­”

### â“ ä¸ºä»€ä¹ˆæ¯”ç‰¹å¸é€‰æ‹©P2Pè€Œä¸æ˜¯æ›´é«˜æ•ˆçš„æ¶æ„ï¼Ÿ

**å›ç­”ï¼š** å°±åƒé—®"ä¸ºä»€ä¹ˆè¦æ°‘ä¸»è€Œä¸è¦ç‹¬è£"ä¸€æ ·ã€‚P2Pè™½ç„¶æ•ˆç‡ä¸æ˜¯æœ€é«˜ï¼Œä½†å®ƒæä¾›äº†æ— ä»·çš„ç‰¹æ€§ï¼š

- ğŸ›ï¸ **å»ä¸­å¿ƒåŒ–**ï¼šæ²¡æœ‰å•ç‚¹æ•…éšœï¼Œæ²¡æœ‰äººèƒ½å…³é—­æ•´ä¸ªç½‘ç»œ
- ğŸ›¡ï¸ **æŠ—å®¡æŸ¥**ï¼šä»»ä½•æ”¿åºœæˆ–ç»„ç»‡éƒ½æ— æ³•æ§åˆ¶
- ğŸŒ **å…¨çƒåŒ–**ï¼šä»»ä½•äººéƒ½å¯ä»¥å‚ä¸ï¼Œæ— éœ€è®¸å¯
- ğŸ’ª **å¼ºå¥æ€§**ï¼šå¤§éƒ¨åˆ†èŠ‚ç‚¹ç¦»çº¿ä¹Ÿä¸å½±å“è¿è¡Œ

æ•ˆç‡å¯ä»¥é€šè¿‡æŠ€æœ¯ä¼˜åŒ–æå‡ï¼Œä½†å»ä¸­å¿ƒåŒ–ä¸€æ—¦å¤±å»å°±å¾ˆéš¾æ‰¾å›ã€‚

### â“ DNSç§å­ä¼šæˆä¸ºå•ç‚¹æ•…éšœå—ï¼Ÿ

**å›ç­”ï¼š** ä¸ä¼šï¼DNSç§å­åªæ˜¯"æ–°äººæŒ‡å—"ï¼Œä¸æ˜¯å¿…éœ€å“ï¼š

**å¤šé‡ä¿é™©ï¼š**
- 9ä¸ªç‹¬ç«‹çš„DNSç§å­æœåŠ¡å™¨ï¼Œåˆ†å¸ƒå…¨çƒ
- å³ä½¿8ä¸ªå¤±æ•ˆï¼Œå‰©ä¸‹1ä¸ªå°±å¤Ÿç”¨
- è€èŠ‚ç‚¹æœ‰è‡ªå·±çš„"é€šè®¯å½•"ï¼Œä¸ä¾èµ–DNSç§å­
- èŠ‚ç‚¹é—´ä¼šäº’ç›¸åˆ†äº«æœ‹å‹çš„è”ç³»æ–¹å¼

**çœŸå®æƒ…å†µï¼š**
- DNSç§å­åªåœ¨ç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶ä½¿ç”¨
- è¿è¡Œä¸­çš„ç½‘ç»œå®Œå…¨ä¸ä¾èµ–DNSç§å­
- å³ä½¿æ‰€æœ‰DNSç§å­éƒ½æ¶ˆå¤±ï¼Œç°æœ‰ç½‘ç»œä»èƒ½æ­£å¸¸è¿è¡Œ

### â“ ä¸ºä»€ä¹ˆè¦é™åˆ¶è¿æ¥æ•°ï¼Ÿä¸ºä»€ä¹ˆä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Ÿ

**å›ç­”ï¼š** å°±åƒæœ‹å‹åœˆä¸€æ ·ï¼Œä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼š

**è¿æ¥å¤ªå°‘çš„é—®é¢˜ï¼š**
- å®¹æ˜“è¢«å­¤ç«‹ï¼ˆæ—¥é£Ÿæ”»å‡»ï¼‰
- æ¶ˆæ¯ä¼ æ’­é€Ÿåº¦æ…¢
- ç½‘ç»œå®¹æ˜“åˆ†è£‚

**è¿æ¥å¤ªå¤šçš„é—®é¢˜ï¼š**
- æ¶ˆè€—å¤§é‡ç½‘ç»œå¸¦å®½
- å¤„ç†æ¶ˆæ¯çš„è®¡ç®—è´Ÿæ‹…é‡
- å®¹æ˜“å—åˆ°æ´ªæ°´æ”»å‡»

**8+125çš„é­”æ³•æ•°å­—ï¼š**
- 8ä¸ªå‡ºç«™è¿æ¥ï¼šç¡®ä¿ç½‘ç»œè¿é€šæ€§
- 125ä¸ªå…¥ç«™è¿æ¥ï¼šä¸ºå…¶ä»–èŠ‚ç‚¹æä¾›æœåŠ¡
- ç»è¿‡å¤šå¹´å®è·µéªŒè¯çš„æœ€ä¼˜å¹³è¡¡ç‚¹

### â“ BIP 324åŠ å¯†ä¼šè®©ç½‘ç»œå˜æ…¢å—ï¼Ÿ

**å›ç­”ï¼š** å‡ ä¹ä¸ä¼šï¼ç°ä»£åŠ å¯†ç®—æ³•éå¸¸é«˜æ•ˆï¼š

**æ€§èƒ½å¯¹æ¯”ï¼š**
```
ChaCha20åŠ å¯†é€Ÿåº¦ï¼š~1GB/sï¼ˆç°ä»£CPUï¼‰
æ¯”ç‰¹å¸ç½‘ç»œå¸¦å®½ï¼š~1MB/sï¼ˆå…¸å‹èŠ‚ç‚¹ï¼‰
åŠ å¯†å¼€é”€ï¼š<1%çš„CPUä½¿ç”¨ç‡
```

**å®é™…æ”¶ç›Šï¼š**
- ğŸ” éšç§ä¿æŠ¤ï¼šå¤–äººæ— æ³•ç›‘å¬ä½ çš„äº¤æ˜“
- ğŸ›¡ï¸ å®‰å…¨æå‡ï¼šé˜²æ­¢ä¸­é—´äººæ”»å‡»
- ğŸ“Š æµé‡æ··æ·†ï¼šéš¾ä»¥è¿›è¡Œæµé‡åˆ†æ
- ğŸš€ æœªæ¥æ‰©å±•ï¼šä¸ºæ›´å¤šåŠŸèƒ½æ‰“åŸºç¡€

å¾®å°çš„æ€§èƒ½å¼€é”€æ¢æ¥å·¨å¤§çš„å®‰å…¨æå‡ï¼Œç»å¯¹å€¼å¾—ï¼

### â“ æ™®é€šç”¨æˆ·éœ€è¦è¿è¡Œå®Œæ•´èŠ‚ç‚¹å—ï¼Ÿ

**å›ç­”ï¼š** ä¸æ˜¯å¿…éœ€çš„ï¼Œä½†å¼ºçƒˆæ¨èæœ‰æ¡ä»¶çš„ç”¨æˆ·è¿è¡Œï¼š

**è½»èŠ‚ç‚¹ï¼ˆSPVï¼‰é€‚åˆï¼š**
- æ‰‹æœºé’±åŒ…ç”¨æˆ·
- å¶å°”ä½¿ç”¨æ¯”ç‰¹å¸çš„ç”¨æˆ·
- ç½‘ç»œæ¡ä»¶å—é™çš„ç”¨æˆ·

**å®Œæ•´èŠ‚ç‚¹é€‚åˆï¼š**
- ç»å¸¸ä½¿ç”¨æ¯”ç‰¹å¸çš„ç”¨æˆ·
- å…³å¿ƒç½‘ç»œå®‰å…¨å’Œå»ä¸­å¿ƒåŒ–çš„ç”¨æˆ·
- æœ‰ç¨³å®šç½‘ç»œå’Œå­˜å‚¨ç©ºé—´çš„ç”¨æˆ·

**è¿è¡Œå®Œæ•´èŠ‚ç‚¹çš„å¥½å¤„ï¼š**
- ğŸ”’ **æœ€é«˜å®‰å…¨æ€§**ï¼šè‡ªå·±éªŒè¯æ‰€æœ‰äº¤æ˜“
- ğŸŒ **æ”¯æŒç½‘ç»œ**ï¼šä¸ºå…¶ä»–ç”¨æˆ·æä¾›æœåŠ¡
- ğŸ—³ï¸ **å‚ä¸æ²»ç†**ï¼šåœ¨åè®®å‡çº§ä¸­æœ‰å‘è¨€æƒ
- ğŸ“Š **å®Œæ•´æ•°æ®**ï¼šå¯ä»¥æŸ¥è¯¢ä»»ä½•å†å²æ•°æ®

### â“ å¦‚ä½•æ£€æµ‹å’Œé˜²èŒƒç½‘ç»œæ”»å‡»ï¼Ÿ

**å›ç­”ï¼š** æ¯”ç‰¹å¸ç½‘ç»œæœ‰å¤šå±‚é˜²æŠ¤æœºåˆ¶ï¼š

**å¸¸è§æ”»å‡»ç±»å‹ï¼š**
- ğŸŒ‘ **æ—¥é£Ÿæ”»å‡»**ï¼šæ¶æ„èŠ‚ç‚¹åŒ…å›´ä½ ï¼Œè®©ä½ çœ‹ä¸åˆ°çœŸå®ç½‘ç»œ
- ğŸ‘¥ **å¥³å·«æ”»å‡»**ï¼šæ”»å‡»è€…åˆ›å»ºå¤§é‡è™šå‡èº«ä»½
- ğŸŒŠ **æ´ªæ°´æ”»å‡»**ï¼šå‘é€å¤§é‡åƒåœ¾æ¶ˆæ¯å µå¡ç½‘ç»œ

**é˜²æŠ¤ç­–ç•¥ï¼š**
```python
def detect_potential_attacks():
    """æ£€æµ‹æ½œåœ¨çš„ç½‘ç»œæ”»å‡»"""
    
    # æ£€æµ‹æ—¥é£Ÿæ”»å‡»
    peer_diversity = check_peer_diversity()
    if peer_diversity < 0.5:
        print("âš ï¸  è­¦å‘Šï¼šè¿æ¥ç¼ºä¹å¤šæ ·æ€§ï¼Œå¯èƒ½é­å—æ—¥é£Ÿæ”»å‡»")
    
    # æ£€æµ‹å¼‚å¸¸æµé‡
    message_rate = get_message_rate()
    if message_rate > NORMAL_THRESHOLD * 10:
        print("âš ï¸  è­¦å‘Šï¼šæ¶ˆæ¯é€Ÿç‡å¼‚å¸¸ï¼Œå¯èƒ½é­å—æ´ªæ°´æ”»å‡»")
    
    # æ£€æµ‹ç‰ˆæœ¬é›†ä¸­
    version_distribution = get_version_distribution()
    if max(version_distribution.values()) > 0.8:
        print("âš ï¸  è­¦å‘Šï¼šè¿æ¥çš„èŠ‚ç‚¹ç‰ˆæœ¬è¿‡äºé›†ä¸­")

# è‡ªåŠ¨é˜²æŠ¤æªæ–½
def auto_defense():
    """è‡ªåŠ¨é˜²æŠ¤æœºåˆ¶"""
    
    # å¤šæ ·åŒ–è¿æ¥
    ensure_geographic_diversity()
    ensure_version_diversity()
    
    # é™åˆ¶è¿æ¥é€Ÿç‡
    implement_rate_limiting()
    
    # ç›‘æ§å¼‚å¸¸è¡Œä¸º
    monitor_peer_behavior()
```

---

## æ€»ç»“

æ¯”ç‰¹å¸P2Pç½‘ç»œæ˜¯ä¸€ä¸ªç²¾å¿ƒè®¾è®¡çš„åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œå°±åƒä¸€ä¸ªæ²¡æœ‰æ‘é•¿çš„ç†æƒ³æ‘åº„ï¼š

### ğŸ›ï¸ è®¾è®¡å“²å­¦
- **å»ä¸­å¿ƒåŒ–ä¼˜å…ˆ**ï¼šå®å¯ç‰ºç‰²æ•ˆç‡ä¹Ÿè¦ä¿è¯å»ä¸­å¿ƒåŒ–
- **æ•°å­¦è¯æ˜**ï¼šç”¨å¯†ç å­¦æ›¿ä»£å¯¹æƒå¨çš„ä¿¡ä»»
- **è‡ªé€‚åº”æ€§**ï¼šç½‘ç»œèƒ½å¤Ÿè‡ªåŠ¨é€‚åº”ç¯å¢ƒå˜åŒ–

### ğŸ”§ æŠ€æœ¯ç‰¹è‰²
- **å¤šé‡å‘ç°**ï¼šDNSç§å­ + ç¡¬ç¼–ç èŠ‚ç‚¹ + å¯¹ç­‰ä¼ æ’­
- **æ™ºèƒ½è¿æ¥**ï¼š8å‡ºç«™+125å…¥ç«™çš„å¹³è¡¡ç­–ç•¥
- **é«˜æ•ˆä¼ æ’­**ï¼šæ´ªæ³›å¼å¹¿æ’­ + å»é‡æœºåˆ¶
- **éšç§å‡çº§**ï¼šBIP 324æä¾›ç«¯åˆ°ç«¯åŠ å¯†

### ğŸŒŸ å®é™…ä»·å€¼
- ç†è§£åŒºå—é“¾ç½‘ç»œå±‚åŸç†
- ä¸ºå…¶ä»–P2Påº”ç”¨æä¾›è®¾è®¡å‚è€ƒ
- æŒæ¡åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ ¸å¿ƒæŠ€æœ¯

æ¯”ç‰¹å¸P2Pç½‘ç»œè¯æ˜äº†ï¼šæ²¡æœ‰ä¸­å¿ƒåŒ–æƒå¨ï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥æ„å»ºå‡ºå®‰å…¨ã€å¯é ã€å…¨çƒåŒ–çš„ç½‘ç»œç³»ç»Ÿã€‚æ¯ä¸€ä¸ªè¿è¡Œæ¯”ç‰¹å¸èŠ‚ç‚¹çš„äººï¼Œéƒ½æ˜¯è¿™ä¸ªå»ä¸­å¿ƒåŒ–é‡‘èç½‘ç»œçš„å®ˆæŠ¤è€…ã€‚

> ğŸ”— **å®Œæ•´ä»£ç å®ç°**ï¼š[p2p_examples.py](./p2p_examples.py)
> 
> ğŸ“š **æ·±å…¥å­¦ä¹ **ï¼š[å®Œæ•´æŠ€æœ¯æ–‡æ¡£](./code_examples/)

---

<div align="center">
<a href="https://github.com/beihaili/Get-Started-with-Web3">ğŸ  è¿”å›ä¸»é¡µ</a> | 
<a href="https://twitter.com/bhbtc1337">ğŸ¦ å…³æ³¨ä½œè€…</a> | 
<a href="https://forms.gle/QMBwL6LwZyQew1tX8">ğŸ“ åŠ å…¥äº¤æµç¾¤</a>
</div>