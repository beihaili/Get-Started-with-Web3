# æ¯”ç‰¹å¸RPCæ¥å£å¼€å‘æŒ‡å—

![status](https://img.shields.io/badge/çŠ¶æ€-è¿›è¡Œä¸­-yellow)
![author](https://img.shields.io/badge/ä½œè€…-beihaili-blue)
![date](https://img.shields.io/badge/æ—¥æœŸ-2025--06-orange)
![difficulty](https://img.shields.io/badge/éš¾åº¦-ä¸­çº§-yellow)

> ğŸ”¥ æœ¬æ•™ç¨‹å°†å¸¦é¢†æ‚¨é€šè¿‡RPCæ¥å£ä¸æ¯”ç‰¹å¸åŒºå—é“¾äº¤äº’ï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°å®ç”¨åº”ç”¨å¼€å‘ï¼Œè®©æ‚¨æ¥è§¦æ¯”ç‰¹å¸ç¼–ç¨‹çš„çœŸå®åŠ›é‡ã€‚

## ç›®å½•

- [å‰è¨€ï¼šé€šè¿‡ä»£ç è¿æ¥æ¯”ç‰¹å¸ä¸–ç•Œ](#å‰è¨€é€šè¿‡ä»£ç è¿æ¥æ¯”ç‰¹å¸ä¸–ç•Œ)
- [1. æ¯”ç‰¹å¸RPCæ¥å£åŸºç¡€](#1-æ¯”ç‰¹å¸rpcæ¥å£åŸºç¡€)
- [2. é…ç½®æ¯”ç‰¹å¸æ ¸å¿ƒRPCæ¥å£](#2-é…ç½®æ¯”ç‰¹å¸æ ¸å¿ƒrpcæ¥å£)
- [3. åŸºæœ¬RPCå‘½ä»¤è¯¦è§£](#3-åŸºæœ¬rpcå‘½ä»¤è¯¦è§£)
- [4. ä½¿ç”¨ç¼–ç¨‹è¯­è¨€è¿æ¥æ¯”ç‰¹å¸èŠ‚ç‚¹](#4-ä½¿ç”¨ç¼–ç¨‹è¯­è¨€è¿æ¥æ¯”ç‰¹å¸èŠ‚ç‚¹)
- [5. æ„å»ºç®€å•åº”ç”¨ç¤ºä¾‹](#5-æ„å»ºç®€å•åº”ç”¨ç¤ºä¾‹)
- [6. ä½¿ç”¨ç¬¬ä¸‰æ–¹RPCæœåŠ¡](#6-ä½¿ç”¨ç¬¬ä¸‰æ–¹rpcæœåŠ¡)
- [7. é«˜çº§æŠ€å·§ä¸æœ€ä½³å®è·µ](#7-é«˜çº§æŠ€å·§ä¸æœ€ä½³å®è·µ)
- [8. æ•…éšœæ’é™¤ä¸å¸¸è§é—®é¢˜](#8-æ•…éšœæ’é™¤ä¸å¸¸è§é—®é¢˜)
- [å¸¸è§é—®é¢˜è§£ç­”](#å¸¸è§é—®é¢˜è§£ç­”)
- [ç»“è¯­](#ç»“è¯­)

## å‰è¨€ï¼šé€šè¿‡ä»£ç è¿æ¥æ¯”ç‰¹å¸ä¸–ç•Œ

åœ¨å‰é¢çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•è¿è¡Œæ¯”ç‰¹å¸å…¨èŠ‚ç‚¹ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨æ¯”ç‰¹å¸æ ¸å¿ƒå®¢æˆ·ç«¯ã€‚ç„¶è€Œï¼Œä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦é€šè¿‡ä»£ç æ¥ä¸æ¯”ç‰¹å¸åŒºå—é“¾äº¤äº’ï¼Œå®ç°è‡ªåŠ¨åŒ–æ“ä½œå’Œè‡ªå®šä¹‰åŠŸèƒ½ã€‚æœ¬ç« å°†æ¢è®¨ä¸¤ç§è®¿é—®æ¯”ç‰¹å¸åŒºå—é“¾çš„æ–¹æ³•ï¼šé€šè¿‡æœ¬åœ°èŠ‚ç‚¹çš„RPCæ¥å£å’Œé€šè¿‡ç¬¬ä¸‰æ–¹æœåŠ¡æä¾›å•†å¦‚QuikNodeã€‚

## 1. æ¯”ç‰¹å¸RPCæ¥å£åŸºç¡€

### 1.1 ä»€ä¹ˆæ˜¯RPCï¼Ÿ

RPCï¼ˆRemote Procedure Callï¼Œè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰æ˜¯ä¸€ç§å…è®¸ç¨‹åºè°ƒç”¨å¦ä¸€ä¸ªåœ°å€ç©ºé—´ï¼ˆé€šå¸¸æ˜¯ç½‘ç»œä¸­çš„å¦ä¸€å°è®¡ç®—æœºï¼‰ä¸Šçš„è¿‡ç¨‹æˆ–å‡½æ•°çš„åè®®ã€‚åœ¨æ¯”ç‰¹å¸ç½‘ç»œä¸­ï¼ŒRPCå…è®¸æˆ‘ä»¬é€šè¿‡HTTPè¯·æ±‚ä¸è¿è¡Œçš„æ¯”ç‰¹å¸èŠ‚ç‚¹è¿›è¡Œé€šä¿¡ã€‚

### 1.2 æ¯”ç‰¹å¸æ ¸å¿ƒçš„RPCæ¶æ„

æ¯”ç‰¹å¸æ ¸å¿ƒå®¢æˆ·ç«¯å†…ç½®äº†RPCæœåŠ¡å™¨ï¼Œå¯ä»¥æ¥æ”¶JSON-RPCè¯·æ±‚å¹¶è¿”å›å“åº”ã€‚è¿™ä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿé€šè¿‡ç®€å•çš„HTTPè¯·æ±‚ä¸æ¯”ç‰¹å¸ç½‘ç»œè¿›è¡Œäº¤äº’ï¼Œè€Œæ— éœ€æ·±å…¥äº†è§£åº•å±‚åè®®ç»†èŠ‚ã€‚

### 1.3 RPCæ¥å£çš„åº”ç”¨åœºæ™¯

+ å¼€å‘æ¯”ç‰¹å¸é’±åŒ…åº”ç”¨
+ åˆ›å»ºåŒºå—æµè§ˆå™¨
+ æ„å»ºäº¤æ˜“ç›‘æ§ç³»ç»Ÿ
+ è‡ªåŠ¨åŒ–èµ„äº§ç®¡ç†
+ å¼€å‘äº¤æ˜“æ‰€åç«¯ç³»ç»Ÿ

## 2. é…ç½®æ¯”ç‰¹å¸æ ¸å¿ƒRPCæ¥å£

### 2.1 ä¿®æ”¹é…ç½®æ–‡ä»¶

è¦å¯ç”¨æ¯”ç‰¹å¸æ ¸å¿ƒçš„RPCåŠŸèƒ½ï¼Œéœ€è¦ä¿®æ”¹bitcoin.confé…ç½®æ–‡ä»¶ã€‚æ ¹æ®ä¸åŒæ“ä½œç³»ç»Ÿï¼Œæ–‡ä»¶ä½ç½®å¦‚ä¸‹ï¼š
+ Windows: `%APPDATA%\Bitcoin\bitcoin.conf`
+ macOS: `~/Library/Application Support/Bitcoin/bitcoin.conf`
+ Linux: `~/.bitcoin/bitcoin.conf`

### 2.2 å…³é”®é…ç½®å‚æ•°

åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

```
server=1
rpcuser=your_username
rpcpassword=your_strong_password
rpcallowip=127.0.0.1
```

### 2.3 é‡å¯æ¯”ç‰¹å¸æ ¸å¿ƒ

é…ç½®ä¿®æ”¹åï¼Œéœ€è¦é‡å¯æ¯”ç‰¹å¸æ ¸å¿ƒå®¢æˆ·ç«¯ä½¿é…ç½®ç”Ÿæ•ˆï¼š
+ GUIæ–¹å¼ï¼šå…³é—­å¹¶é‡æ–°æ‰“å¼€bitcoin-qt
+ å‘½ä»¤è¡Œæ–¹å¼ï¼š`bitcoin-cli stop` ç„¶å `bitcoind -daemon`

## 3. åŸºæœ¬RPCå‘½ä»¤è¯¦è§£

### 3.1 åŒºå—é“¾ä¿¡æ¯æŸ¥è¯¢

+ `getblockchaininfo` - è·å–åŒºå—é“¾çŠ¶æ€ä¿¡æ¯
+ `getblockcount` - è·å–å½“å‰åŒºå—é«˜åº¦
+ `getblock <hash>` - è·å–æŒ‡å®šåŒºå—çš„è¯¦ç»†ä¿¡æ¯
+ `getblockhash <height>` - è·å–æŒ‡å®šé«˜åº¦çš„åŒºå—å“ˆå¸Œ

### 3.2 é’±åŒ…æ“ä½œå‘½ä»¤

+ `getbalance` - è·å–é’±åŒ…ä½™é¢
+ `getnewaddress` - ç”Ÿæˆæ–°åœ°å€
+ `listunspent` - åˆ—å‡ºæœªèŠ±è´¹çš„äº¤æ˜“è¾“å‡º
+ `dumpprivkey <address>` - å¯¼å‡ºç§é’¥ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰

### 3.3 äº¤æ˜“ç›¸å…³å‘½ä»¤

+ `createrawtransaction` - åˆ›å»ºåŸå§‹äº¤æ˜“
+ `signrawtransactionwithwallet` - ç­¾åäº¤æ˜“
+ `sendrawtransaction` - å¹¿æ’­äº¤æ˜“åˆ°ç½‘ç»œ
+ `gettransaction <txid>` - è·å–äº¤æ˜“è¯¦æƒ…

## 4. ä½¿ç”¨ç¼–ç¨‹è¯­è¨€è¿æ¥æ¯”ç‰¹å¸èŠ‚ç‚¹

### 4.1 Pythonç¤ºä¾‹

ä½¿ç”¨python-bitcoinrpcåº“ä¸æ¯”ç‰¹å¸èŠ‚ç‚¹äº¤äº’ï¼š

```python
from bitcoinrpc.authproxy import AuthServiceProxy

# è¿æ¥åˆ°æœ¬åœ°æ¯”ç‰¹å¸èŠ‚ç‚¹
rpc_connection = AuthServiceProxy("http://your_username:your_password@127.0.0.1:8332")

# è·å–åŒºå—é“¾ä¿¡æ¯
blockchain_info = rpc_connection.getblockchaininfo()
print("å½“å‰åŒºå—é«˜åº¦:", blockchain_info['blocks'])
print("å½“å‰åŒºå—é“¾å¤§å°:", blockchain_info['size_on_disk'] / (1024**3), "GB")

# è·å–æœ€æ–°åŒºå—å“ˆå¸Œ
best_block_hash = rpc_connection.getbestblockhash()
print("æœ€æ–°åŒºå—å“ˆå¸Œ:", best_block_hash)

# è·å–åŒºå—è¯¦æƒ…
block = rpc_connection.getblock(best_block_hash)
print("åŒºå—æ—¶é—´:", block['time'])
print("äº¤æ˜“æ•°é‡:", len(block['tx']))

# è·å–é’±åŒ…ä½™é¢
balance = rpc_connection.getbalance()
print("é’±åŒ…ä½™é¢:", balance, "BTC")
```

### 4.2 JavaScript/Node.jsç¤ºä¾‹

ä½¿ç”¨bitcoind-rpcåº“ä¸æ¯”ç‰¹å¸èŠ‚ç‚¹äº¤äº’ï¼š

```javascript
const Client = require('bitcoin-core');

// è¿æ¥åˆ°æœ¬åœ°æ¯”ç‰¹å¸èŠ‚ç‚¹
const client = new Client({
  host: '127.0.0.1',
  port: 8332,
  username: 'your_username',
  password: 'your_password'
});

// è·å–åŒºå—é“¾ä¿¡æ¯
client.getBlockchainInfo()
  .then(blockchainInfo => {
    console.log("å½“å‰åŒºå—é«˜åº¦:", blockchainInfo.blocks);
    console.log("å½“å‰åŒºå—é“¾å¤§å°:", blockchainInfo.size_on_disk / (1024**3), "GB");
    
    // è·å–æœ€æ–°åŒºå—å“ˆå¸Œ
    return client.getBestBlockHash();
  })
  .then(bestBlockHash => {
    console.log("æœ€æ–°åŒºå—å“ˆå¸Œ:", bestBlockHash);
    
    // è·å–åŒºå—è¯¦æƒ…
    return client.getBlock(bestBlockHash);
  })
  .then(block => {
    console.log("åŒºå—æ—¶é—´:", new Date(block.time * 1000).toISOString());
    console.log("äº¤æ˜“æ•°é‡:", block.tx.length);
    
    // è·å–é’±åŒ…ä½™é¢
    return client.getBalance();
  })
  .then(balance => {
    console.log("é’±åŒ…ä½™é¢:", balance, "BTC");
  })
  .catch(error => {
    console.error("å‘ç”Ÿé”™è¯¯:", error);
  });
```

### 4.3 å…¶ä»–è¯­è¨€çš„è°ƒç”¨æ–¹å¼

#### Java (ä½¿ç”¨ bitcoinj)

```java
import wf.bitcoin.javabitcoindrpcclient.BitcoinJSONRPCClient;

public class BitcoinRpcExample {
    public static void main(String[] args) {
        try {
            // è¿æ¥åˆ°æœ¬åœ°æ¯”ç‰¹å¸èŠ‚ç‚¹
            BitcoinJSONRPCClient client = new BitcoinJSONRPCClient(
                "http://your_username:your_password@127.0.0.1:8332");
            
            // è·å–åŒºå—é“¾ä¿¡æ¯
            System.out.println("åŒºå—é«˜åº¦: " + client.getBlockCount());
            
            // è·å–é’±åŒ…ä½™é¢
            System.out.println("é’±åŒ…ä½™é¢: " + client.getBalance() + " BTC");
            
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

#### Go

```go
package main

import (
	"fmt"
	"log"
	
	"github.com/btcsuite/btcd/rpcclient"
)

func main() {
	// è¿æ¥é…ç½®
	connCfg := &rpcclient.ConnConfig{
		Host:         "127.0.0.1:8332",
		User:         "your_username",
		Pass:         "your_password",
		HTTPPostMode: true,
		DisableTLS:   true,
	}
	
	// åˆ›å»ºæ–°å®¢æˆ·ç«¯
	client, err := rpcclient.New(connCfg, nil)
	if err != nil {
		log.Fatal(err)
	}
	defer client.Shutdown()
	
	// è·å–åŒºå—é“¾ä¿¡æ¯
	blockCount, err := client.GetBlockCount()
	if err != nil {
		log.Fatal(err)
	}
	fmt.Printf("åŒºå—é«˜åº¦: %d\n", blockCount)
	
	// è·å–åŒºå—å“ˆå¸Œ
	blockHash, err := client.GetBlockHash(blockCount)
	if err != nil {
		log.Fatal(err)
	}
	fmt.Printf("æœ€æ–°åŒºå—å“ˆå¸Œ: %s\n", blockHash.String())
}
```

## 5. æ„å»ºç®€å•åº”ç”¨ç¤ºä¾‹

### 5.1 åˆ›å»ºåŒºå—é“¾æµè§ˆå™¨

è¿™æ˜¯ä¸€ä¸ªç®€å•çš„åŒºå—é“¾æµè§ˆå™¨Webåº”ç”¨ï¼Œä½¿ç”¨Flaskæ¡†æ¶å®ç°ã€‚å®ƒå…è®¸æ‚¨æµè§ˆåŒºå—é“¾ä¸Šçš„åŒºå—å’Œäº¤æ˜“ä¿¡æ¯ï¼Œå¹¶æä¾›æœç´¢åŠŸèƒ½ã€‚

![åŒºå—é“¾æµè§ˆå™¨ä¸»ç•Œé¢](./blockchain_explorer/img/æµè§ˆå™¨ä¸»ç•Œé¢.jpg)

åŒºå—é“¾æµè§ˆå™¨çš„ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š
- æ˜¾ç¤ºåŒºå—é“¾çš„åŸºæœ¬ä¿¡æ¯ï¼ˆåŒºå—é«˜åº¦ã€éš¾åº¦ã€åŒæ­¥è¿›åº¦ç­‰ï¼‰
- åˆ—å‡ºæœ€è¿‘çš„åŒºå—
- æŸ¥çœ‹åŒºå—è¯¦æƒ…
- æŸ¥çœ‹äº¤æ˜“è¯¦æƒ…
- æœç´¢ç‰¹å®šåŒºå—æˆ–äº¤æ˜“

ä»¥ä¸‹æ˜¯åŒºå—é“¾æµè§ˆå™¨çš„æ ¸å¿ƒä»£ç ï¼š

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
æ¯”ç‰¹å¸åŒºå—é“¾æµè§ˆå™¨ - åŸºäºFlaskçš„Webåº”ç”¨
æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨æ¯”ç‰¹å¸RPCæ¥å£æ„å»ºç®€å•çš„åŒºå—é“¾æµè§ˆå™¨
"""

from flask import Flask, render_template, request, redirect
from bitcoinrpc.authproxy import AuthServiceProxy
import datetime

app = Flask(__name__)

# æ·»åŠ æ—¶é—´æˆ³è½¬æ—¥æœŸè¿‡æ»¤å™¨
@app.template_filter('timestamp_to_date')
def timestamp_to_date(timestamp):
    """å°†Unixæ—¶é—´æˆ³è½¬æ¢ä¸ºå¯è¯»æ—¥æœŸ"""
    return datetime.datetime.fromtimestamp(timestamp).strftime('%Y-%m-%d %H:%M:%S')

# æ¯”ç‰¹å¸RPCè¿æ¥
def get_rpc_connection():
    # Bitcoin RPC settings
    rpc_user = "your_username"
    rpc_password = "your_password"
    rpc_host = "127.0.0.1"
    rpc_port = 8332
    rpc_url = f"http://{rpc_user}:{rpc_password}@{rpc_host}:{rpc_port}"
    return AuthServiceProxy(rpc_url)

@app.route('/')
def index():
    rpc = get_rpc_connection()
    
    # è·å–åŒºå—é“¾ä¿¡æ¯
    blockchain_info = rpc.getblockchaininfo()
    best_block_hash = rpc.getbestblockhash()
    latest_blocks = []
    
    # è·å–æœ€è¿‘10ä¸ªåŒºå—
    current_hash = best_block_hash
    for _ in range(10):
        if current_hash:
            block = rpc.getblock(current_hash)
            latest_blocks.append({
                'height': block['height'],
                'hash': block['hash'],
                'time': block['time'],
                'tx_count': len(block['tx'])
            })
            if 'previousblockhash' in block:
                current_hash = block['previousblockhash']
            else:
                break
    
    return render_template('index.html', 
                          blockchain_info=blockchain_info,
                          latest_blocks=latest_blocks)

@app.route('/block/<blockhash>')
def block_detail(blockhash):
    rpc = get_rpc_connection()
    
    try:
        # è·å–åŒºå—è¯¦æƒ…
        block = rpc.getblock(blockhash)
        return render_template('block.html', block=block)
    except:
        return "åŒºå—æœªæ‰¾åˆ°", 404

@app.route('/tx/<txid>')
def transaction_detail(txid):
    rpc = get_rpc_connection()
    
    try:
        # è·å–äº¤æ˜“è¯¦æƒ…
        raw_tx = rpc.getrawtransaction(txid, 1)
        return render_template('transaction.html', tx=raw_tx)
    except:
        return "äº¤æ˜“æœªæ‰¾åˆ°", 404

@app.route('/search')
def search():
    query = request.args.get('q', '')
    
    if not query:
        return redirect('/')
    
    rpc = get_rpc_connection()
    
    # å°è¯•ä½œä¸ºåŒºå—é«˜åº¦å¤„ç†
    try:
        height = int(query)
        block_hash = rpc.getblockhash(height)
        return redirect(f'/block/{block_hash}')
    except:
        pass
    
    # å°è¯•ä½œä¸ºåŒºå—å“ˆå¸Œå¤„ç†
    try:
        rpc.getblock(query)
        return redirect(f'/block/{query}')
    except:
        pass
    
    # å°è¯•ä½œä¸ºäº¤æ˜“IDå¤„ç†
    try:
        rpc.getrawtransaction(query, 1)
        return redirect(f'/tx/{query}')
    except:
        pass
    
    return "æœªæ‰¾åˆ°ç›¸å…³ç»“æœ", 404

if __name__ == '__main__':
    app.run(debug=True)
```

![åŒºå—é“¾æµè§ˆå™¨åŒºå—è¯¦æƒ…](./blockchain_explorer/img/æµè§ˆå™¨åŒºå—è¯¦æƒ….jpg)

è¦è¿è¡Œæ­¤åº”ç”¨ï¼Œæ‚¨éœ€è¦åˆ›å»ºä»¥ä¸‹ç›®å½•ç»“æ„ï¼š

```
/templates
  /index.html - æ˜¾ç¤ºåŒºå—é“¾æ¦‚è§ˆå’Œæœ€è¿‘åŒºå—åˆ—è¡¨
  /block.html - æ˜¾ç¤ºåŒºå—è¯¦æƒ…
  /transaction.html - æ˜¾ç¤ºäº¤æ˜“è¯¦æƒ…
```

ä½¿ç”¨æ–¹æ³•ï¼š

```bash
# å®‰è£…ä¾èµ–
pip install flask python-bitcoinrpc

# è¿è¡Œåº”ç”¨
python blockchain_explorer.py

# åœ¨æµè§ˆå™¨ä¸­è®¿é—®
# http://127.0.0.1:5000
```

### 5.2 äº¤æ˜“ç›‘æ§å·¥å…·

è¿™æ˜¯ä¸€ä¸ªç›‘æ§ç‰¹å®šæ¯”ç‰¹å¸åœ°å€äº¤æ˜“çš„è„šæœ¬ï¼Œå½“æ£€æµ‹åˆ°æ–°äº¤æ˜“æ—¶ä¼šè‡ªåŠ¨æé†’ï¼š

### 5.2 äº¤æ˜“ç›‘æ§å·¥å…·

æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªåŸºäºmempool.space APIçš„æ¯”ç‰¹å¸åœ°å€ç›‘æ§å·¥å…·ï¼Œå¯ä»¥ç›‘æ§ä»»æ„æ¯”ç‰¹å¸åœ°å€çš„äº¤æ˜“æ´»åŠ¨ã€‚å®Œæ•´ä»£ç ä½äº `address_monitor/address_monitor.py`ã€‚

è¯¥å·¥å…·çš„ä¸»è¦åŠŸèƒ½ï¼š
- ç›‘æ§æŒ‡å®šæ¯”ç‰¹å¸åœ°å€çš„æ‰€æœ‰äº¤æ˜“
- å½“æ£€æµ‹åˆ°æ–°äº¤æ˜“æ—¶å‘å‡ºæé†’
- æ˜¾ç¤ºäº¤æ˜“é‡‘é¢ã€æ—¶é—´å’ŒåŒºå—é“¾æµè§ˆå™¨é“¾æ¥

ä½¿ç”¨æ–¹æ³•ï¼š

```bash
# å®‰è£…ä¾èµ–
pip install requests

# è¿è¡Œè„šæœ¬ï¼Œç›‘æ§æŒ‡å®šåœ°å€
python address_monitor/address_monitor.py 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa

# æŒ‡å®šæ£€æŸ¥é—´éš”
python address_monitor/address_monitor.py 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa -i 30
```

ä½¿ç”¨æ–¹æ³•ï¼š

```bash
# å®‰è£…ä¾èµ–
pip install requests

# è¿è¡Œè„šæœ¬ï¼Œç›‘æ§æŒ‡å®šåœ°å€
python address_monitor.py 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa

# æŒ‡å®šæ£€æŸ¥é—´éš”
python address_monitor.py 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa -i 30
```

## 6. ä½¿ç”¨ç¬¬ä¸‰æ–¹RPCæœåŠ¡æä¾›å•†

è¿è¡Œå…¨èŠ‚ç‚¹éœ€è¦å¤§é‡çš„å­˜å‚¨ç©ºé—´ï¼ˆè¶…è¿‡660GBï¼‰å’ŒåŒæ­¥æ—¶é—´ã€‚å¯¹äºå¼€å‘è€…è€Œè¨€ï¼Œä½¿ç”¨ç¬¬ä¸‰æ–¹RPCæœåŠ¡æä¾›å•†å¦‚QuikNodeæ˜¯ä¸€ä¸ªå®ç”¨çš„æ›¿ä»£æ–¹æ¡ˆï¼Œå°¤å…¶æ˜¯åœ¨å¼€å‘å’Œæµ‹è¯•é˜¶æ®µã€‚

### 6.1 ç¬¬ä¸‰æ–¹RPCæœåŠ¡çš„ä¼˜åŠ¿

+ **æ— éœ€åŒæ­¥åŒºå—é“¾**ï¼šç«‹å³å¼€å§‹å¼€å‘ï¼Œæ— éœ€ç­‰å¾…åŒºå—é“¾åŒæ­¥
+ **æ— éœ€å¤§é‡å­˜å‚¨ç©ºé—´**ï¼šä¸éœ€è¦åœ¨æœ¬åœ°å­˜å‚¨å®Œæ•´çš„åŒºå—é“¾æ•°æ®
+ **é«˜å¯ç”¨æ€§**ï¼šä¸“ä¸šæœåŠ¡æä¾›å•†é€šå¸¸æä¾›é«˜å¯ç”¨æ€§å’Œå†—ä½™èŠ‚ç‚¹
+ **ä¸“ä¸šç»´æŠ¤**ï¼šèŠ‚ç‚¹ç”±ä¸“ä¸šå›¢é˜Ÿç»´æŠ¤ï¼Œç¡®ä¿æœ€æ–°çš„å®‰å…¨è¡¥ä¸å’Œæ›´æ–°

### 6.2 å¸¸è§çš„æ¯”ç‰¹å¸RPCæœåŠ¡æä¾›å•†

1. **QuikNode** - https://quiknode.io/
2. **BlockCypher** - https://www.blockcypher.com/
3. **Infura** (æ¯”ç‰¹å¸æ”¯æŒ) - https://infura.io/
4. **GetBlock** - https://getblock.io/
5. **NOWNodes** - https://nownodes.io/

### 6.3 ä½¿ç”¨QuikNodeçš„æ¯”ç‰¹å¸RPCæœåŠ¡

#### 6.3.1 åˆ›å»ºQuikNodeè´¦æˆ·å’ŒèŠ‚ç‚¹

1. è®¿é—® [QuikNodeå®˜ç½‘](https://quiknode.io/) å¹¶æ³¨å†Œè´¦æˆ·
2. åœ¨æ§åˆ¶é¢æ¿ä¸­ï¼Œé€‰æ‹©"Create Endpoint"
3. é€‰æ‹©æ¯”ç‰¹å¸ç½‘ç»œï¼ˆä¸»ç½‘æˆ–æµ‹è¯•ç½‘ï¼‰
4. é€‰æ‹©åˆé€‚çš„å¥—é¤ï¼ˆåŒ…æ‹¬å…è´¹è¯•ç”¨é€‰é¡¹ï¼‰

#### 6.3.2 ä½¿ç”¨Pythonè¿æ¥QuikNode

ä¸ä¼ ç»Ÿçš„æ¯”ç‰¹å¸èŠ‚ç‚¹RPCä¸åŒï¼ŒQuikNode URLä¸éœ€è¦åœ¨URLä¸­åŒ…å«ç”¨æˆ·åå’Œå¯†ç ï¼Œèº«ä»½éªŒè¯é€šè¿‡APIå¯†é’¥ï¼ˆå·²åŒ…å«åœ¨URLä¸­ï¼‰å®Œæˆã€‚ä½¿ç”¨requestsåº“ç›´æ¥å‘é€HTTPè¯·æ±‚æ˜¯æ›´çµæ´»çš„è§£å†³æ–¹æ¡ˆï¼š

```python
# ç¤ºä¾‹ä»£ç  (å®Œæ•´ä»£ç è§ quiknode_examples/quiknode_client.py)
import requests

class BitcoinRPC:
    def __init__(self, url):
        self.url = url
        self.id_counter = 0

    def call(self, method, params=None):
        # å‘é€JSON-RPCè¯·æ±‚åˆ°QuikNodeç«¯ç‚¹
        # ...çœç•¥å®ç°ç»†èŠ‚...

# ä½¿ç”¨ç¤ºä¾‹
quiknode_url = "https://example.quiknode.pro/your-api-key/"
rpc = BitcoinRPC(quiknode_url)

# è·å–åŒºå—é“¾ä¿¡æ¯
blockchain_info = rpc.call("getblockchaininfo")
print("å½“å‰åŒºå—é«˜åº¦:", blockchain_info['blocks'])
```

#### 6.3.3 ä½¿ç”¨Node.jsè¿æ¥QuikNode

```javascript
// ç¤ºä¾‹ä»£ç  (å®Œæ•´ä»£ç è§ quiknode_examples/nodejs_client.js)
const axios = require('axios');

class BitcoinRPC {
  constructor(url) {
    this.url = url;
    this.idCounter = 0;
  }

  async call(method, params = []) {
    // å‘é€JSON-RPCè¯·æ±‚åˆ°QuikNodeç«¯ç‚¹
    // ...çœç•¥å®ç°ç»†èŠ‚...
  }
}

// ä½¿ç”¨ç¤ºä¾‹
async function main() {
  const quiknodeUrl = 'https://example.quiknode.pro/your-api-key/';
  const rpc = new BitcoinRPC(quiknodeUrl);

  try {
    // è·å–åŒºå—é“¾ä¿¡æ¯
    const blockchainInfo = await rpc.call('getblockchaininfo');
    console.log('å½“å‰åŒºå—é«˜åº¦:', blockchainInfo.blocks);
    
    // è·å–æœ€æ–°åŒºå—å“ˆå¸Œ
    const bestBlockHash = await rpc.call('getbestblockhash');
    console.log('æœ€æ–°åŒºå—å“ˆå¸Œ:', bestBlockHash);
  } catch (error) {
    console.error('å‘ç”Ÿé”™è¯¯:', error);
  }
}
```

### 6.4 æ¯”è¾ƒæœ¬åœ°èŠ‚ç‚¹ä¸ç¬¬ä¸‰æ–¹RPCæœåŠ¡

| ç‰¹æ€§ | æœ¬åœ°èŠ‚ç‚¹ | ç¬¬ä¸‰æ–¹RPCæœåŠ¡ |
|---------|----------|---------------|
| å®Œå…¨è‡ªä¸»æ€§ | âœ… å®Œå…¨æ§åˆ¶ | âŒ ä¾èµ–ç¬¬ä¸‰æ–¹ |
| éœ€è¦å­˜å‚¨ç©ºé—´ | âŒ 660GB+ | âœ… æ— éœ€æœ¬åœ°å­˜å‚¨ |
| åˆå§‹è®¾ç½®æ—¶é—´ | âŒ æ•°å¤©è‡³æ•°å‘¨ | âœ… ç«‹å³å¯ç”¨ |
| ç»´æŠ¤æˆæœ¬ | âŒ éœ€è¦è‡ªè¡Œç»´æŠ¤ | âœ… æ— éœ€ç»´æŠ¤ |
| è¯è´¹ | âœ… åªæœ‰ç¡¬ä»¶å’Œç”µè´¹æˆæœ¬ | âŒ éœ€è¦æœˆè´¹/å¹´è´¹ |
| éšç§ä¿æŠ¤ | âœ… æ•°æ®åœ¨æœ¬åœ° | âŒ é€šè¿‡ç¬¬ä¸‰æ–¹è®¿é—® |
| æ€§èƒ½ä¸å¯é æ€§ | å–å†³äºç¡¬ä»¶æ€§èƒ½ | âœ… ä¸“ä¸šçº§æœåŠ¡ä¿éšœ |

**å»ºè®®**ï¼š
- å¼€å‘å’Œæµ‹è¯•é˜¶æ®µï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹RPCæœåŠ¡
- ç”Ÿäº§ç¯å¢ƒï¼šå¦‚æœæ³¨é‡éšç§å’Œè‡ªä¸»æ€§ï¼Œè€ƒè™‘è¿è¡Œè‡ªå·±çš„èŠ‚ç‚¹
- æ··åˆæ–¹æ¡ˆï¼šä½¿ç”¨è‡ªå·±çš„èŠ‚ç‚¹ä½œä¸ºä¸»è¦è®¿é—®ç‚¹ï¼Œç¬¬ä¸‰æ–¹æœåŠ¡ä½œä¸ºå¤‡ç”¨

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
æ¯”ç‰¹å¸äº¤æ˜“ç›‘æ§å·¥å…· - ç›‘æ§æŒ‡å®šåœ°å€çš„äº¤æ˜“
æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨æ¯”ç‰¹å¸RPCæ¥å£ç›‘æ§ç‰¹å®šåœ°å€çš„äº¤æ˜“æ´»åŠ¨
"""

import time
import sys
import argparse
from bitcoinrpc.authproxy import AuthServiceProxy

def monitor_address(address, check_interval=60):
    """
    ç›‘æ§ç‰¹å®šæ¯”ç‰¹å¸åœ°å€çš„äº¤æ˜“
    
    å‚æ•°:
    address: è¦ç›‘æ§çš„æ¯”ç‰¹å¸åœ°å€
    check_interval: æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰
    """
    # æ¯”ç‰¹å¸RPCè¿æ¥é…ç½®
    rpc_user = "your_username"
    rpc_password = "your_password"
    rpc_host = "127.0.0.1"
    rpc_port = 8332
    rpc_url = f"http://{rpc_user}:{rpc_password}@{rpc_host}:{rpc_port}"
    
    rpc = AuthServiceProxy(rpc_url)
    
    # è®°å½•å·²çŸ¥äº¤æ˜“
    known_txs = set()
    
    print(f"å¼€å§‹ç›‘æ§åœ°å€: {address}")
    print(f"æ£€æŸ¥é—´éš”: {check_interval}ç§’")
    print("Ctrl+C é€€å‡ºç›‘æ§")
    print("="*50)
    # ç¡®ä¿è¾“å‡ºç«‹å³æ˜¾ç¤º
    sys.stdout.flush()
    
    try:
        while True:
            try:
                print("æ­£åœ¨æ£€æŸ¥æ–°äº¤æ˜“...")
                sys.stdout.flush()
                # è·å–åœ°å€ç›¸å…³äº¤æ˜“
                received = rpc.listreceivedbyaddress(0, True)
                
                # æ‰¾åˆ°æŒ‡å®šåœ°å€çš„è®°å½•
                address_found = False
                print(f"è·å–åˆ° {len(received)} ä¸ªåœ°å€è®°å½•")
                sys.stdout.flush()
                for entry in received:
                    print(f"æ£€æŸ¥åœ°å€: {entry['address']}")
                    sys.stdout.flush()
                    if entry['address'] == address:
                        address_found = True
                        # æ£€æŸ¥æ–°äº¤æ˜“
                        current_txs = set(entry['txids'])
                        new_txs = current_txs - known_txs
                        
                        # å¤„ç†æ–°äº¤æ˜“
                        for txid in new_txs:
                            tx = rpc.gettransaction(txid)
                            amount = sum([detail['amount'] for detail in tx['details'] 
                                        if detail['address'] == address and detail['category'] == 'receive'])
                            
                            print(f"\næ£€æµ‹åˆ°æ–°äº¤æ˜“: {txid}")
                            print(f"  é‡‘é¢: {amount} BTC")
                            print(f"  ç¡®è®¤æ•°: {tx['confirmations']}")
                            print(f"  æ—¶é—´: {time.ctime(tx['time'])}")
                            print("-" * 50)
                        
                        # æ›´æ–°å·²çŸ¥äº¤æ˜“
                        known_txs = current_txs
                        
                        # è·å–æ€»ä½™é¢
                        balance = rpc.getreceivedbyaddress(address)
                        print(f"å½“å‰åœ°å€ä½™é¢: {balance} BTC")
                        break
                
                if not address_found:
                    print(f"è­¦å‘Š: åœ°å€ {address} æœªåœ¨é’±åŒ…ä¸­æ‰¾åˆ°æˆ–å°šæ— äº¤æ˜“")
                
            except Exception as e:
                print(f"å‘ç”Ÿé”™è¯¯: {e}")
            
            # æ˜¾ç¤ºå½“å‰æ—¶é—´
            print(f"æœ€åæ£€æŸ¥æ—¶é—´: {time.ctime()}")
            print("ç­‰å¾…ä¸‹ä¸€æ¬¡æ£€æŸ¥...\n")
            sys.stdout.flush()
            
            # ç­‰å¾…ä¸‹ä¸€æ¬¡æ£€æŸ¥
            time.sleep(check_interval)
            
    except KeyboardInterrupt:
        print("\nç›‘æ§å·²åœæ­¢")

def main():
    """ä¸»å‡½æ•°"""
    parser = argparse.ArgumentParser(description='æ¯”ç‰¹å¸åœ°å€äº¤æ˜“ç›‘æ§å·¥å…·')
    parser.add_argument('address', help='è¦ç›‘æ§çš„æ¯”ç‰¹å¸åœ°å€')
    parser.add_argument('-i', '--interval', type=int, default=60,
                        help='æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰ï¼Œé»˜è®¤60ç§’')
    
    args = parser.parse_args()
    
    try:
        monitor_address(args.address, args.interval)
    except Exception as e:
        print(f"ç›‘æ§è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯: {e}")

if __name__ == "__main__":
    main()
```

æˆ‘ä»¬è¿˜æä¾›äº†ä¸€ä¸ªåŸºäºæœ¬åœ°èŠ‚ç‚¹ RPC æ¥å£çš„æ¯”ç‰¹å¸åœ°å€ç›‘æ§å·¥å…·ï¼Œè¯¥å·¥å…·å¯ä»¥æ£€æµ‹ä½ æ‰€è¿è¡Œçš„æ¯”ç‰¹å¸èŠ‚ç‚¹ä¸­æŒ‡å®šåœ°å€çš„äº¤æ˜“æ´»åŠ¨ã€‚å®Œæ•´ä»£ç ä½äº `address_monitor/rpc_address_monitor.py`ã€‚
ä½¿ç”¨æ–¹æ³•ï¼š

```bash
# å®‰è£…ä¾èµ–
pip install python-bitcoinrpc

# è¿è¡Œç›‘æ§å·¥å…·
python address_monitor/rpc_address_monitor.py <æ¯”ç‰¹å¸åœ°å€>

# è‡ªå®šä¹‰æ£€æŸ¥é—´éš”ï¼ˆä¾‹å¦‚30ç§’ï¼‰
python address_monitor/rpc_address_monitor.py <æ¯”ç‰¹å¸åœ°å€> --interval 30
```

è¿è¡Œç¤ºä¾‹ï¼š

```
å¼€å§‹ç›‘æ§åœ°å€: bc1qn8gu85e8fkujheu5vt6229g0hcfuxh6nklthus
æ£€æŸ¥é—´éš”: 10ç§’
Ctrl+C é€€å‡ºç›‘æ§
==================================================
æ­£åœ¨æ£€æŸ¥æ–°äº¤æ˜“...
è·å–åˆ° 2 ä¸ªåœ°å€è®°å½•
æ£€æŸ¥åœ°å€: bc1qwqw3mcx60ek4upr9c4xu4nfh36jzhk2qyg9zzp
æ£€æŸ¥åœ°å€: bc1qn8gu85e8fkujheu5vt6229g0hcfuxh6nklthus
å½“å‰åœ°å€ä½™é¢: 0E-8 BTC
æœ€åæ£€æŸ¥æ—¶é—´: Sun Jun  1 17:50:15 2025
ç­‰å¾…ä¸‹ä¸€æ¬¡æ£€æŸ¥...
```

è¿™ä¸ªå·¥å…·çš„ä¸»è¦åŠŸèƒ½ï¼š
- æŒç»­ç›‘æ§æŒ‡å®šæ¯”ç‰¹å¸åœ°å€çš„äº¤æ˜“
- æ£€æµ‹æ–°çš„äº¤æ˜“å¹¶æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
- æ˜¾ç¤ºåœ°å€å½“å‰ä½™é¢
- æ”¯æŒè‡ªå®šä¹‰æ£€æŸ¥é—´éš”
- å¯ä»¥æ–¹ä¾¿åœ°é€šè¿‡å‘½ä»¤è¡Œå‚æ•°æ“ä½œ
- æä¾›è¯¦ç»†çš„è°ƒè¯•è¾“å‡ºä¿¡æ¯

## 6. é«˜çº§RPCåº”ç”¨

### 6.1 æ‰¹é‡å¤„ç†äº¤æ˜“
ä¸‹é¢æ˜¯ä¸€ä¸ªæ‰¹é‡åˆ›å»ºå’Œå‘é€äº¤æ˜“çš„ç¤ºä¾‹ï¼š

å®Œæ•´ä»£ç è¯·æŸ¥çœ‹ `advanced_examples/batch_transactions.py`ã€‚

```python
# ç¤ºä¾‹ä»£ç æ‘˜è¦
from bitcoinrpc.authproxy import AuthServiceProxy

def batch_send_transactions(outputs_list, fee_rate=10):
    # è¿æ¥åˆ°æ¯”ç‰¹å¸èŠ‚ç‚¹
    rpc = AuthServiceProxy("http://beihaili:your_password@127.0.0.1:8332")
    
    # æ£€æŸ¥é’±åŒ…ä½™é¢
    balance = rpc.getbalance()
    total_to_send = sum(output['amount'] for output in outputs_list)
    
    # åˆ›å»ºæ‰¹é‡äº¤æ˜“
    for output in outputs_list:
        # åˆ›å»ºåŸå§‹äº¤æ˜“ï¼Œèµ„é‡‘æ³¨å…¥ï¼Œç­¾åå¹¶å¹¿æ’­
        # ...çœç•¥è¯¦ç»†å®ç°...
```

### 6.2 ä¸å…¶ä»–ç³»ç»Ÿé›†æˆ

è¿™æ˜¯ä¸€ä¸ªå°†æ¯”ç‰¹å¸RPCä¸WebæœåŠ¡é›†æˆçš„Express.jsåº”ç”¨ç¤ºä¾‹ï¼š

å®Œæ•´ä»£ç è¯·æŸ¥çœ‹ `advanced_examples/express_api_server.js`ã€‚

```javascript
// ç¤ºä¾‹ä»£ç æ‘˜è¦
const express = require('express');
const Client = require('bitcoin-core');
const bodyParser = require('body-parser');

const app = express();
app.use(bodyParser.json());

// æ¯”ç‰¹å¸RPCå®¢æˆ·ç«¯
const bitcoinClient = new Client({
  host: '127.0.0.1',
  port: 8332,
  username: 'beihaili',  // ä½¿ç”¨ç”¨æˆ·å®é™…ç”¨æˆ·å
  password: 'your_password'
});

// APIç«¯ç‚¹ç¤ºä¾‹
app.get('/api/blockchain/info', async (req, res) => {
  // è·å–åŒºå—é“¾ä¿¡æ¯
});

app.get('/api/block/:hash', async (req, res) => {
  // è·å–ç‰¹å®šåŒºå—ä¿¡æ¯
});

app.get('/api/wallet/balance', async (req, res) => {
  // è·å–é’±åŒ…ä½™é¢
});

// ç­‰æ›´å¤šç«¯ç‚¹...
```

## 7. å®‰å…¨ä¸æ€§èƒ½æœ€ä½³å®è·µ

### 7.1 RPCå®‰å…¨é…ç½®

1. **ä½¿ç”¨SSLåŠ å¯†**

é€šè¿‡ä¿®æ”¹bitcoin.confå¯ç”¨SSLåŠ å¯†ï¼š

```
rpcssl=1
rpcsslcertificatechainfile=server.cert
rpcsslprivatekeyfile=server.key
```

2. **é˜²ç«å¢™è®¾ç½®**

åªå…è®¸å¿…è¦çš„IPåœ°å€è®¿é—®RPCç«¯å£ï¼š

```
rpcallowip=192.168.1.100/32
```

3. **é™åˆ¶RPCç”¨æˆ·æƒé™**

ä¸ºä¸åŒçš„åº”ç”¨åˆ›å»ºä¸åŒçš„RPCç”¨æˆ·ï¼Œé™åˆ¶æƒé™ï¼š

```
rpcauth=user1:hash$salt
```

4. **å®šæœŸæ›´æ”¹å¯†ç **

å®šæœŸæ›´æ”¹RPCç”¨æˆ·å¯†ç ï¼Œå°¤å…¶æ˜¯åœ¨äººå‘˜å˜åŠ¨åã€‚

### 7.2 æ€§èƒ½ä¼˜åŒ–

1. **ä½¿ç”¨æ‰¹å¤„ç†è¯·æ±‚**

æ‰¹å¤„ç†å¤šä¸ªRPCè¯·æ±‚å¯ä»¥å‡å°‘ç½‘ç»œå¼€é”€ï¼š

```python
# æ‰¹å¤„ç†è¯·æ±‚ç¤ºä¾‹
results = rpc_connection.batch_([
    ["getblock", latest_block_hash],
    ["getbalance"],
    ["getmempoolinfo"]
])
```

2. **ç¼“å­˜å¸¸ç”¨æ•°æ®**

å¯¹ä¸ç»å¸¸å˜åŒ–çš„æ•°æ®è¿›è¡Œç¼“å­˜ï¼š

```python
import functools
from datetime import datetime, timedelta

# å¸¦è¶…æ—¶çš„ç¼“å­˜è£…é¥°å™¨
def cache_with_timeout(timeout_seconds=60):
    def decorator(func):
        cache = {}
        
        @functools.wraps(func)
        def wrapper(*args, **kwargs):
            key = str(args) + str(kwargs)
            current_time = datetime.now()
            
            if key in cache:
                result, timestamp = cache[key]
                if current_time - timestamp < timedelta(seconds=timeout_seconds):
                    return result
            
            result = func(*args, **kwargs)
            cache[key] = (result, current_time)
            return result
        
        return wrapper
    return decorator

# ä½¿ç”¨ç¼“å­˜è£…é¥°å™¨
@cache_with_timeout(300)  # ç¼“å­˜5åˆ†é’Ÿ
def get_blockchain_info(rpc):
    return rpc.getblockchaininfo()
```

3. **å¼‚æ­¥å¤„ç†**

å¯¹äºå¤§é‡RPCè°ƒç”¨ï¼Œä½¿ç”¨å¼‚æ­¥å¤„ç†é¿å…é˜»å¡ï¼š

```python
import asyncio
import aiohttp
import json
import base64

async def async_rpc_call(method, params=None):
    """å¼‚æ­¥RPCè°ƒç”¨"""
    url = "http://127.0.0.1:8332"
    auth = base64.b64encode(b"your_username:your_password").decode()
    headers = {
        "Content-Type": "application/json",
        "Authorization": f"Basic {auth}"
    }
    
    payload = {
        "jsonrpc": "1.0",
        "id": "curltest",
        "method": method,
        "params": params or []
    }
    
    async with aiohttp.ClientSession() as session:
        async with session.post(url, json=payload, headers=headers) as response:
            if response.status == 200:
                return await response.json()
            else:
                raise Exception(f"RPCé”™è¯¯: {response.status}")

async def process_blocks(start_height, count):
    """å¼‚æ­¥å¤„ç†å¤šä¸ªåŒºå—"""
    tasks = []
    
    # åˆ›å»ºä»»åŠ¡
    for height in range(start_height, start_height + count):
        # è·å–åŒºå—å“ˆå¸Œ
        hash_task = asyncio.create_task(
            async_rpc_call("getblockhash", [height])
        )
        tasks.append(hash_task)
    
    # ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ
    block_hashes = await asyncio.gather(*tasks)
    
    # è·å–åŒºå—è¯¦æƒ…
    block_tasks = []
    for result in block_hashes:
        if 'result' in result:
            block_task = asyncio.create_task(
                async_rpc_call("getblock", [result['result']])
            )
            block_tasks.append(block_task)
    
    blocks = await asyncio.gather(*block_tasks)
    return blocks

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    # å¤„ç†æœ€è¿‘çš„10ä¸ªåŒºå—
    loop = asyncio.get_event_loop()
    current_height = loop.run_until_complete(async_rpc_call("getblockcount"))
    start_height = current_height['result'] - 10
    
    blocks = loop.run_until_complete(process_blocks(start_height, 10))
    print(f"å¼‚æ­¥å¤„ç†äº† {len(blocks)} ä¸ªåŒºå—")
```

## 8. æ•…éšœæ’é™¤ä¸å¸¸è§é—®é¢˜

### 8.1 è¿æ¥é—®é¢˜

| é—®é¢˜ | å¯èƒ½åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|----------|----------|
| æ— æ³•è¿æ¥åˆ°RPCæœåŠ¡å™¨ | æ¯”ç‰¹å¸æ ¸å¿ƒæœªè¿è¡Œ | ç¡®ä¿æ¯”ç‰¹å¸æ ¸å¿ƒå·²å¯åŠ¨å¹¶æ­£åœ¨è¿è¡Œ |
| | RPCæœªå¯ç”¨ | åœ¨bitcoin.confä¸­è®¾ç½®server=1 |
| | é˜²ç«å¢™é˜»æ­¢ | æ£€æŸ¥é˜²ç«å¢™è®¾ç½®ï¼Œç¡®ä¿å…è®¸8332ç«¯å£ |
| è®¤è¯å¤±è´¥ | ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ | æ£€æŸ¥bitcoin.confä¸­çš„rpcuserå’Œrpcpasswordè®¾ç½® |
| | è®¿é—®IPä¸åœ¨å…è®¸åˆ—è¡¨ | æ·»åŠ å®¢æˆ·ç«¯IPåˆ°rpcallowipè®¾ç½® |
| è¿æ¥è¶…æ—¶ | èŠ‚ç‚¹è´Ÿè½½è¿‡é«˜ | å¢åŠ å®¢æˆ·ç«¯è¶…æ—¶è®¾ç½®ï¼Œå‡å°‘å¹¶å‘è¯·æ±‚ |

### 8.2 æ€§èƒ½é—®é¢˜

1. **èŠ‚ç‚¹åŒæ­¥é—®é¢˜**

å¦‚æœèŠ‚ç‚¹å°šæœªå®Œå…¨åŒæ­¥ï¼ŒæŸäº›RPCè°ƒç”¨å¯èƒ½ä¼šå¤±è´¥æˆ–è¿”å›ä¸å®Œæ•´æ•°æ®ã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥åŒæ­¥çŠ¶æ€ï¼š

```python
# æ£€æŸ¥èŠ‚ç‚¹åŒæ­¥çŠ¶æ€
sync_status = rpc.getblockchaininfo()
is_synced = sync_status['initialblockdownload'] == False
progress = sync_status['verificationprogress'] * 100

print(f"èŠ‚ç‚¹åŒæ­¥è¿›åº¦: {progress:.2f}%")
print(f"æ˜¯å¦å·²å®ŒæˆåŒæ­¥: {'æ˜¯' if is_synced else 'å¦'}")
```

2. **å†…å­˜ä½¿ç”¨è¿‡é«˜**

å¤„ç†å¤§é‡äº¤æ˜“æˆ–åŒºå—æ•°æ®æ—¶ï¼Œå¯èƒ½å¯¼è‡´å†…å­˜ä½¿ç”¨è¿‡é«˜ï¼š

å®Œæ•´ä»£ç è¯·æŸ¥çœ‹ `performance_tips/batch_processing.py`

```python
# åˆ†æ‰¹å¤„ç†å¤§é‡æ•°æ®ç¤ºä¾‹
def process_large_dataset(start_item, total_items, batch_size=100):
    results = []
    
    for offset in range(0, total_items, batch_size):
        # å¤„ç†å½“å‰æ‰¹æ¬¡å¹¶é‡Šæ”¾å†…å­˜
        # ...çœç•¥è¯¦ç»†å®ç°...
```

3. **å¤„ç†é”™è¯¯å“åº”**

ä¼˜é›…åœ°å¤„ç†RPCé”™è¯¯ï¼š

å®Œæ•´ä»£ç è¯·æŸ¥çœ‹ `performance_tips/safe_rpc_calls.py`

```python
def safe_rpc_call(rpc_func, *args, max_retries=3, retry_delay=2):
    """å®‰å…¨åœ°è°ƒç”¨RPCå‡½æ•°ï¼Œå¤„ç†å¸¸è§é”™è¯¯"""
    retries = 0
    while retries < max_retries:
        try:
            return rpc_func(*args)  # å°è¯•è°ƒç”¨RPCå‡½æ•°
        except Exception as e:
            # åˆ¤æ–­é”™è¯¯ç±»å‹å¹¶å†³å®šæ˜¯å¦é‡è¯•
            # ...çœç•¥è¯¦ç»†å®ç°...
```

## å¸¸è§é—®é¢˜è§£ç­”

#### â“ æˆ‘éœ€è¦è¿è¡Œå®Œæ•´èŠ‚ç‚¹æ‰èƒ½ä½¿ç”¨RPCåŠŸèƒ½å—ï¼Ÿ

æ˜¯çš„ï¼Œè¦ä½¿ç”¨å®Œæ•´çš„æ¯”ç‰¹å¸RPCåŠŸèƒ½ï¼Œæ‚¨éœ€è¦è¿è¡Œä¸€ä¸ªæ¯”ç‰¹å¸å…¨èŠ‚ç‚¹æˆ–ä½¿ç”¨ç¬¬ä¸‰æ–¹RPCæœåŠ¡ã€‚ä¸ºäº†æµ‹è¯•å¹¶å­¦ä¹ RPCå‘½ä»¤ï¼Œæ‚¨ä¹Ÿå¯ä»¥åœ¨æµ‹è¯•ç½‘ç»œï¼ˆtestnetï¼‰æˆ–å›å½’æµ‹è¯•ç½‘ç»œï¼ˆregtestï¼‰ä¸Šè¿è¡ŒèŠ‚ç‚¹ï¼Œè¿™æ ·å¯ä»¥é¿å…å¤§é‡çš„åŒºå—é“¾æ•°æ®ä¸‹è½½å’ŒåŒæ­¥æ—¶é—´ã€‚

#### â“ RPCè°ƒç”¨å¯ä»¥æ§åˆ¶æ¯”ç‰¹å¸èŠ‚ç‚¹çš„å®‰å…¨æ€§å—ï¼Ÿ

æ˜¯çš„ï¼ŒRPCè°ƒç”¨å¯ä»¥æ§åˆ¶æ¯”ç‰¹å¸èŠ‚ç‚¹çš„å¤§éƒ¨åˆ†åŠŸèƒ½ï¼ŒåŒ…æ‹¬ç®¡ç†é’±åŒ…ã€å‘é€äº¤æ˜“ç­‰æ•æ„Ÿæ“ä½œã€‚å› æ­¤ï¼Œä¿æŠ¤æ‚¨çš„RPCå‡­è¯éå¸¸é‡è¦ï¼š

1. ä½¿ç”¨å¼ºå¯†ç å¹¶å®šæœŸæ›´æ”¹
2. é™åˆ¶RPCè®¿é—®åªèƒ½æ¥è‡ªæœ¬åœ°æˆ–ä¿¡ä»»çš„IPï¼ˆä½¿ç”¨`rpcallowip`è®¾ç½®ï¼‰
3. è€ƒè™‘ä½¿ç”¨SSLåŠ å¯†é€šä¿¡
4. é¿å…åœ¨å…¬å¼€çš„äº’è”ç½‘ä¸Šæš´éœ²RPCç«¯å£

#### â“ æˆ‘çš„ä»£ç å‘é€RPCè¯·æ±‚å¾ˆæ…¢ï¼Œå¦‚ä½•æé«˜æ€§èƒ½ï¼Ÿ

æœ‰å‡ ç§æ–¹æ³•å¯ä»¥æé«˜RPCè¯·æ±‚æ€§èƒ½ï¼š

1. **æ‰¹é‡å¤„ç†**ï¼šå°è£…å¤šä¸ªRPCå‘½ä»¤ä¸ºä¸€ä¸ªè¯·æ±‚ï¼Œå‡å°‘ç½‘ç»œå¾€è¿”
2. **å¼‚æ­¥è°ƒç”¨**ï¼šä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ï¼ˆå¦‚Pythonçš„asyncioæˆ–JavaScriptçš„Promiseï¼‰
3. **å†…å­˜ç¼“å­˜**ï¼šç¼“å­˜ä¸ç»å¸¸å˜åŒ–çš„æ•°æ®ï¼Œå¦‚å·²ç¡®è®¤çš„åŒºå—
4. **ä¼˜åŒ–æŸ¥è¯¢**ï¼šåªè¯·æ±‚éœ€è¦çš„æ•°æ®ï¼Œä¾‹å¦‚ä½¿ç”¨verbosityå‚æ•°æ§åˆ¶è¿”å›æ•°æ®é‡
5. **æå‡èŠ‚ç‚¹ç”µè„‘ç¡¬ä»¶**ï¼šç‰¹åˆ«æ˜¯ä½¿ç”¨SSDå’Œæ›´å¤šçš„RAM

#### â“ å¦‚ä½•å®šä½å¸¸è§çš„RPCé”™è¯¯ï¼Ÿ

å¸¸è§é”™è¯¯åŠå…¶è§£å†³æ–¹æ¡ˆï¼š

1. **è¿æ¥è¢«æ‹’ç»**ï¼šæ£€æŸ¥bitcoin.confä¸­çš„rpcallowipè®¾ç½®
2. **æ— æ•ˆå‡­è¯**ï¼šéªŒè¯rpcuserå’Œrpcpasswordè®¾ç½®
3. **æ–¹æ³•ä¸å­˜åœ¨**ï¼šæ£€æŸ¥å‘½ä»¤æ‹¼å†™å’Œè¯­æ³•ï¼Œæˆ–æŸ¥çœ‹æ‚¨å½“å‰æ¯”ç‰¹å¸æ ¸å¿ƒç‰ˆæœ¬æ˜¯å¦æ”¯æŒè¯¥å‘½ä»¤
4. **èŠ‚ç‚¹åŒæ­¥ä¸­**ï¼šç­‰å¾…èŠ‚ç‚¹å®ŒæˆåŒæ­¥åå†è°ƒç”¨éƒ¨åˆ†å‘½ä»¤

#### â“ å¯ä»¥é€šè¿‡RPCåˆ›å»ºå¤šç­¾åäº¤æ˜“å—ï¼Ÿ

æ˜¯çš„ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤åˆ›å»ºå¤šç­¾åäº¤æ˜“ï¼š

1. ä½¿ç”¨`createrawtransaction`åˆ›å»ºåŸå§‹äº¤æ˜“
2. ç”¨`signrawtransactionwithwallet`éƒ¨åˆ†ç­¾åè¯¥äº¤æ˜“
3. å°†éƒ¨åˆ†ç­¾åçš„äº¤æ˜“å‘é€ç»™å…¶ä»–éœ€è¦ç­¾åçš„æ–¹
4. ä½¿ç”¨`combinepsbt`åˆå¹¶å¤šä¸ªç­¾åçš„éƒ¨åˆ†
5. æœ€åç”¨`sendrawtransaction`å¹¿æ’­å®Œæˆçš„äº¤æ˜“

å¤šç­¾ååŠŸèƒ½åº”ç”¨äºå¤šç­¾åé’±åŒ…ã€å®‰å…¨ä¿ç®¡å’Œå¤æ‚çš„äº¤æ˜“æµç¨‹ã€‚

## å‚è€ƒ

+ [æ¯”ç‰¹å¸æ ¸å¿ƒRPCæ–‡æ¡£](https://developer.bitcoin.org/reference/rpc/)
+ [æ¯”ç‰¹å¸å¼€å‘è€…æŒ‡å—](https://developer.bitcoin.org/devguide/index.html)
+ [python-bitcoinrpc](https://github.com/jgarzik/python-bitcoinrpc)
+ [bitcoind-rpc for Node.js](https://github.com/bitpay/bitcoind-rpc)

## ç»“è¯­

é€šè¿‡æ¯”ç‰¹å¸RPCæ¥å£ç¼–ç¨‹ï¼Œæ‚¨è¸å…¥äº†ä¸€ä¸ªå…¨æ–°çš„å¼€å‘é¢†åŸŸâ€”â€”ä¸€ä¸ªæ‚¨å¯ä»¥ç›´æ¥ä¸ä¸–ç•Œä¸Šæœ€æœ‰ä»·å€¼çš„å»ä¸­å¿ƒåŒ–ç½‘ç»œäº¤äº’çš„é¢†åŸŸã€‚è¿™ä¸ä»…ä»…æ˜¯æŠ€æœ¯å­¦ä¹ ï¼Œè€Œæ˜¯å¯¹ä¸€åœºé‡‘èé©å‘½çš„ç›´æ¥å‚ä¸ã€‚

å½“æ‚¨å‘é€ä¸€ä¸ªRPCå‘½ä»¤æ¥æŸ¥è¯¢åŒºå—é“¾ä¿¡æ¯æˆ–åˆ›å»ºäº¤æ˜“æ—¶ï¼Œæ‚¨ä¸ä»…åœ¨ä½¿ç”¨æ¯”ç‰¹å¸ï¼Œè€Œæ˜¯åœ¨ä¸ºè¿™ä¸ªå…¨çƒåŒ–ã€å»ä¸­å¿ƒåŒ–çš„é‡‘èç½‘ç»œæ„å»ºæ–°å·¥å…·å’ŒæœåŠ¡ã€‚åœ¨æ¯”ç‰¹å¸ç”Ÿæ€ç³»ç»Ÿä¸­ï¼Œæ¯ä¸€ä¸ªå¼€å‘è€…éƒ½æ˜¯åˆ›æ–°è€…å’Œå˜é©è€…ã€‚

æ‚¨å¯èƒ½ä»å°å‹åº”ç”¨å¼€å§‹ï¼Œä½†è¿™äº›çŸ¥è¯†å’Œç»éªŒå¯ä»¥æˆä¸ºæ›´éš¾å¾—çš„åˆ›æ–°çš„è·³æ¿ï¼š

- æ„å»ºä¸‹ä¸€ä»£åŒºå—æµè§ˆå™¨æˆ–é’±åŒ…åº”ç”¨
- å¼€å‘é«˜çº§é‡‘èå·¥å…·ï¼Œå¼ºåŒ–äºå¤šç­¾åäº¤æ˜“
- åˆ›é€ æ•°æ®åˆ†æå¹³å°ï¼ŒæŒ–æ˜åŒºå—é“¾ä¸Šçš„æ´»åŠ¨è¶‹åŠ¿
- è”æ¥æ¯”ç‰¹å¸ç½‘ç»œä¸å…¶ä»–é‡‘èç³»ç»Ÿæˆ–ç°å®ä¸–ç•Œåº”ç”¨

æ¯”ç‰¹å¸çš„æŠ€æœ¯åŸºç¡€æ­£åœ¨ä¸æ–­å‘å±•â€”â€”é—ªç”µç½‘ç»œã€ä¾§é“¾ã€Taprootç­‰æŠ€æœ¯ä¸æ–­æ‰©å±•å…¶èƒ½åŠ›å’Œç”¨ä¾‹ã€‚æ‚¨ç°åœ¨æ‰€æŒæ¡çš„RPCçŸ¥è¯†æ˜¯é€šå‘è¿™ä¸ªæ–°é‡‘èä¸–ç•Œçš„é’¥åŒ™ï¼Œè®©æ‚¨å¯ä»¥æˆä¸ºè¿™åœºé©å‘½çš„ç§¯æå‚ä¸è€…å’Œå»ºè®¾è€…ã€‚

æ¯ä¸€ä¸ªRPCè°ƒç”¨èƒŒåï¼Œéƒ½æœ‰æ•°å­¦ã€å¯†ç å­¦ã€ç»æµå­¦å’Œè®¡ç®—æœºç§‘å­¦çš„ç²¾å¦™èåˆã€‚è¿™ä¸ä»…æ˜¯ç¼–ç¨‹ï¼Œæ›´æ˜¯å¯¹é‡‘èæœªæ¥çš„æ¢ç´¢ä¸åˆ›é€ ã€‚

---

<div align="center">
<a href="https://github.com/beihaili/Get-Started-with-Web3">ğŸ  è¿”å›ä¸»é¡µ</a> | 
<a href="https://twitter.com/bhbtc1337">ğŸ¦ å…³æ³¨ä½œè€…</a> | 
<a href="https://forms.gle/QMBwL6LwZyQew1tX8">ğŸ“ åŠ å…¥äº¤æµç¾¤</a>
</div>
